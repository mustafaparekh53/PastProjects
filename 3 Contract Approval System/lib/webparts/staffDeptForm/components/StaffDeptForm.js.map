{"version":3,"sources":["../../src/webparts/staffDeptForm/components/StaffDeptForm.tsx"],"names":[],"mappings":"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","file":"webparts/staffDeptForm/components/StaffDeptForm.js","sourcesContent":["import * as React from \"react\";\r\nimport styles from \"./StaffDeptForm.module.scss\";\r\nimport { IStaffDeptFormProps } from \"./IStaffDeptFormProps\";\r\nimport { sp } from \"@pnp/sp\";\r\nimport \"@pnp/polyfill-ie11\";\r\nimport { WebConfig } from \"../../ComComponents/webconfig\";\r\nimport UxpList from \"../../ComComponents/UxpList/UxpList\";\r\nimport {\r\n  IObjectWithKey,\r\n  SelectionMode\r\n} from \"office-ui-fabric-react/lib/DetailsList\";\r\nimport { IStaffDeptFormState } from \"./IStaffDeptFormState\";\r\nimport { Dropdown, IDropdownOption } from \"office-ui-fabric-react/lib/Dropdown\";\r\nimport { Checkbox } from \"office-ui-fabric-react/lib/Checkbox\";\r\nimport {\r\n  DefaultButton,\r\n  PrimaryButton\r\n} from \"office-ui-fabric-react/lib/Button\";\r\nimport {\r\n  Dialog,\r\n  DialogFooter,\r\n  DialogType\r\n} from \"office-ui-fabric-react/lib/Dialog\";\r\nimport {\r\n  OfficeUiFabricPeoplePickerContainer,\r\n  IOfficeUiFabricPeoplePickerSelection\r\n} from \"../../../components/officeUiFabricPeoplePicker\";\r\n\r\nexport default class StaffDeptForm extends React.Component<\r\n  IStaffDeptFormProps,\r\n  IStaffDeptFormState\r\n> {\r\n  constructor(props: any) {\r\n    super(props);\r\n    this.state = {\r\n      StaffIds: [], // undefined,\r\n      DeptId: undefined,\r\n      ChangeExists: false,\r\n      ErrMsg: \"\",\r\n      hideDeleteDialog: true,\r\n      curItemId: 0,\r\n      selectedItems: []\r\n    };\r\n  }\r\n  public render(): React.ReactElement<IStaffDeptFormProps> {\r\n    return (\r\n      <div className={styles.staffDeptForm}>\r\n        <div className={styles.container}>\r\n          <fieldset>\r\n            <legend>\r\n              <h3>新建员工部门信息</h3>\r\n            </legend>\r\n            <div className=\"ms-Grid\">\r\n              <div className=\"ms-Grid-row\">\r\n                <div\r\n                  className=\"ms-Grid-col ms-sm12 ms-md6 ms-lg6\"\r\n                  style={{ paddingLeft: \"10px\", paddingRight: \"20px\" }}\r\n                >\r\n                  <OfficeUiFabricPeoplePickerContainer\r\n                    label={\"员工邮箱\"}\r\n                    principalTypeUser={true}\r\n                    principalTypeSharePointGroup={false}\r\n                    principalTypeSecurityGroup={false}\r\n                    principalTypeDistributionList={false}\r\n                    itemLimit={1}\r\n                    maximumEntitySuggestions={5}\r\n                    onChange={this._StaffChanged}\r\n                    selections={this.state.selections}\r\n                  />\r\n                </div>\r\n                <div\r\n                  className=\"ms-Grid-col ms-sm12 ms-md6 ms-lg6\"\r\n                  style={{ paddingLeft: \"10px\", paddingRight: \"20px\" }}\r\n                >\r\n                  <Dropdown\r\n                    label={\"部门\"}\r\n                    selectedKey={this.state.DeptId ? this.state.DeptId : null}\r\n                    options={this.props.deptOptions}\r\n                    onChanged={this.changeDeptState}\r\n                  />\r\n                </div>\r\n              </div>\r\n              <div className=\"ms-Grid-row\" style={{ marginTop: \"10px\" }}>\r\n                <div\r\n                  className=\"ms-Grid-col ms-sm12 ms-md6 ms-lg6\"\r\n                  style={{ paddingLeft: \"10px\", paddingRight: \"20px\" }}\r\n                >\r\n                  <Checkbox\r\n                    label=\"变更已有合同申请\"\r\n                    checked={this.state.ChangeExists}\r\n                    onChange={this._onExistsChange}\r\n                    ariaDescribedBy={\"descriptionID\"}\r\n                  />\r\n                </div>\r\n                <div className=\"ms-Grid-col ms-sm12 ms-md6 ms-lg6\">\r\n                  <DefaultButton\r\n                    data-automation-id=\"btnApp\"\r\n                    checked={true}\r\n                    text={this.state.curItemId === 0 ? \"确认添加\" : \"确认修改\"}\r\n                    onClick={this._AddClicked}\r\n                  />\r\n                </div>\r\n              </div>\r\n              <div style={{ width: \"100%\", textAlign: \"center\" }}>\r\n                <span style={{ color: \"Red\" }}>{this.state.ErrMsg}</span>\r\n              </div>\r\n            </div>\r\n          </fieldset>\r\n          <hr />\r\n          <UxpList\r\n            data={this.props.staffItems}\r\n            schemaFields={[\r\n              {\r\n                ariaLabel: \"员工邮箱\",\r\n                Name: \"Staff\"\r\n              },\r\n              {\r\n                ariaLabel: \"部门\",\r\n                Name: \"Dept\"\r\n              },\r\n              {\r\n                ariaLabel: \"添加时间\",\r\n                Name: \"Created\"\r\n              },\r\n              {\r\n                ariaLabel: \"添加人\",\r\n                Name: \"Author\"\r\n              }\r\n            ]}\r\n            onDeleteButtonClicked={this.onDeleteStaffs}\r\n            selectionMode={SelectionMode.multiple}\r\n            hiddenFields={[\"key\"]}\r\n            // newButtonTitle=\"新建\"\r\n            label={\"已添加的员工部门配置\"}\r\n          />\r\n        </div>\r\n        <Dialog\r\n          hidden={this.state.hideDeleteDialog}\r\n          onDismiss={this._closeDeleteDialog}\r\n          dialogContentProps={{\r\n            type: DialogType.normal,\r\n            title: \"删除确认\",\r\n            subText: \"你确认要删除选中记录吗?\"\r\n          }}\r\n          modalProps={{\r\n            isBlocking: false\r\n          }}\r\n        >\r\n          <DialogFooter>\r\n            <PrimaryButton onClick={this._deleteStaffs} text={\"删除记录\"} />\r\n            <DefaultButton onClick={this._closeDeleteDialog} text=\"取消\" />\r\n          </DialogFooter>\r\n        </Dialog>\r\n      </div>\r\n    );\r\n  }\r\n  private _StaffChanged = (staffs?: IOfficeUiFabricPeoplePickerSelection[]) => {\r\n    let itemId: number = 0;\r\n    if (staffs.length > 0) {\r\n      sp.web.lists\r\n        .getByTitle(WebConfig.StaffDeptListName)\r\n        .items.filter(\"StaffId eq \" + staffs[0].id)\r\n        .get()\r\n        .then(staffItems => {\r\n          if (staffItems.length > 0) {\r\n            itemId = staffItems[0].Id;\r\n          }\r\n          this.setState({ StaffIds: [staffs[0].id], curItemId: itemId });\r\n        });\r\n    } else {\r\n      this.setState({ StaffIds: [], curItemId: itemId });\r\n    }\r\n  };\r\n\r\n  private changeDeptState = (item: IDropdownOption) => {\r\n    this.setState({ DeptId: item.key as number });\r\n  };\r\n\r\n  private _onExistsChange = (_, isChecked: boolean) => {\r\n    this.setState({ ChangeExists: isChecked });\r\n  };\r\n\r\n  private _AddClicked = () => {\r\n    // console.log(this.state.StaffDept);\r\n    if (this.state.StaffIds.length === 0) {\r\n      alert(\"请填写有效的员工邮箱。\");\r\n      return;\r\n    } else if (this.state.DeptId === undefined) {\r\n      alert(\"请选择部门。\");\r\n      return;\r\n    }\r\n\r\n    if (this.state.StaffIds.length > 0 && this.state.DeptId) {\r\n      if (this.state.curItemId === 0) {\r\n        this.props\r\n          .addStaffItem(\r\n            this.state.StaffIds[0],\r\n            this.state.DeptId,\r\n            this.state.ChangeExists\r\n          )\r\n          .then(() => {\r\n            this.setState(\r\n              {\r\n                StaffIds: [],\r\n                DeptId: undefined,\r\n                ChangeExists: false,\r\n                ErrMsg: \"添加成功！\",\r\n                selections: []\r\n              },\r\n              () => {\r\n                setTimeout(() => {\r\n                  this.setState(() => ({ ErrMsg: \"\" }));\r\n                }, 2000);\r\n              }\r\n            );\r\n          })\r\n          .catch((error: any) => {\r\n            let errMsg: string = error.data\r\n              ? error.data.responseBody[\"odata.error\"].message.value\r\n              : error.message;\r\n            this.setState({ ErrMsg: \"添加失败:\" + errMsg });\r\n          });\r\n      } else {\r\n        this.props\r\n          .updateStaffItem(\r\n            this.state.curItemId,\r\n            this.state.StaffIds[0],\r\n            this.state.DeptId,\r\n            this.state.ChangeExists\r\n          )\r\n          .then(item => {\r\n            this.setState(\r\n              {\r\n                StaffIds: [],\r\n                DeptId: null,\r\n                ChangeExists: false,\r\n                ErrMsg: \"修改成功！\",\r\n                selections: []\r\n              },\r\n              () => {\r\n                setTimeout(() => {\r\n                  this.setState(() => ({ ErrMsg: \"\" }));\r\n                }, 2000);\r\n              }\r\n            );\r\n          })\r\n          .catch((error: any) => {\r\n            let errMsg: string = error.data\r\n              ? error.data.responseBody[\"odata.error\"].message.value\r\n              : error.message;\r\n            this.setState({ ErrMsg: \"修改失败:\" + errMsg });\r\n          });\r\n      }\r\n    }\r\n  };\r\n\r\n  private onDeleteStaffs = (items: IObjectWithKey[]) => {\r\n    this.setState({ hideDeleteDialog: false, selectedItems: items });\r\n  };\r\n\r\n  private _closeDeleteDialog = () => {\r\n    this.setState({ hideDeleteDialog: true });\r\n  };\r\n\r\n  private _deleteStaffs = () => {\r\n    this.props\r\n      .deleteStaffItems(this.state.selectedItems)\r\n      .then(() => {\r\n        this._closeDeleteDialog();\r\n      })\r\n      .catch((error: any) => {\r\n        console.log(error);\r\n        this._closeDeleteDialog();\r\n      });\r\n  };\r\n}\r\n"],"sourceRoot":"..\\..\\..\\..\\src"}