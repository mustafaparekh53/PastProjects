{"version":3,"sources":["../../src/webparts/approvalForm/components/AppItemForm.tsx"],"names":[],"mappings":"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","file":"webparts/approvalForm/components/AppItemForm.js","sourcesContent":["import React = require(\"react\");\r\nimport { IApprovalFormState } from \"./IApprovalFormState\";\r\nimport { IApprovalFormProps } from \"./IApprovalFormProps\";\r\nimport { Apprhistory } from \"./appresults/Apprhistory\";\r\n\r\nimport { autobind } from \"@uifabric/utilities\";\r\nimport { IColumnField } from \"../../ComComponents/interfaces/IColumnField\";\r\nimport { IApprovalItemProps } from \"./IApprovalItemProps\";\r\nimport * as ReactQuill from \"react-quill\";\r\nimport * as QuillNamespace from \"quill\";\r\nlet Quill: any = QuillNamespace;\r\nconst Delta = Quill.import(\"delta\");\r\nimport \"react-quill/dist/quill.snow.css\";\r\nimport { sp, Item } from \"@pnp/sp\";\r\nimport \"@pnp/polyfill-ie11\";\r\nimport { IItem } from \"../../ComComponents/interfaces/IItem\";\r\nimport { WebConfig } from \"../../ComComponents/webconfig\";\r\nimport { Attachments } from \"../../contractForm/components/Attachments/Attachments\";\r\nimport CollapsePanel from \"../../ComComponents/collapsepanel/CollapsePanel\";\r\nimport * as objectAssign from \"object-assign\";\r\nimport * as moment from \"moment\";\r\nimport \"moment/locale/zh-cn\";\r\nimport { GetFileRandName } from \"../../ComComponents/comutil\";\r\nimport { Label } from \"office-ui-fabric-react/lib/Label\";\r\nimport {\r\n  DefaultButton,\r\n  PrimaryButton\r\n} from \"office-ui-fabric-react/lib/Button\";\r\nexport class AppItemForm extends React.Component<\r\n  IApprovalItemProps,\r\n  IApprovalFormState\r\n> {\r\n  private quillRef: any;\r\n  private formats: any[] = [\r\n    \"header\",\r\n    \"bold\",\r\n    \"italic\",\r\n    \"underline\",\r\n    \"strike\",\r\n    \"blockquote\",\r\n    \"list\",\r\n    \"bullet\",\r\n    \"indent\",\r\n    \"link\",\r\n    \"image\"\r\n  ];\r\n  FileUpload: HTMLInputElement;\r\n  constructor(props: any) {\r\n    super(props);\r\n    this.state = {\r\n      requestedItemsListFields: [\r\n        {\r\n          ariaLabel: \"合同类型\",\r\n          Name: \"ContractType\"\r\n        },\r\n        {\r\n          ariaLabel: \"合同编号\",\r\n          Name: \"ContractNo\"\r\n        },\r\n        {\r\n          ariaLabel: \"合同名称\",\r\n          Name: \"Title\"\r\n        },\r\n        {\r\n          ariaLabel: \"合同标的和数量\",\r\n          Name: \"ContractObject\"\r\n        },\r\n        {\r\n          ariaLabel: \"合同金额\",\r\n          Name: \"MoneyText\"\r\n        },\r\n        {\r\n          ariaLabel: \"付款方式\",\r\n          Name: \"PayWay\"\r\n        },\r\n        {\r\n          ariaLabel: \"备注\",\r\n          Name: \"remarks\"\r\n        },\r\n        {\r\n          ariaLabel: \"附件\",\r\n          Type: \"linkArray\",\r\n          Name: \"AttachmentFiles\"\r\n        },\r\n        {\r\n          ariaLabel: \"是否送审价中心审批\",\r\n          Name: \"NeedApproval\"\r\n        },\r\n        {\r\n          ariaLabel: \"状态\",\r\n          Name: \"statusDesc\"\r\n        }\r\n      ] as IColumnField[],\r\n      curUser: null,\r\n      sendtype: \"\",\r\n      submited: false,\r\n      curItem: null\r\n    };\r\n  }\r\n  public render(): React.ReactElement<IApprovalFormProps> {\r\n    return (\r\n      <div className=\"ms-Grid\">\r\n        <div className=\"ms-Grid-row\">\r\n          <div className=\"ms-Grid-col ms-sm12 ms-md12 ms-lg12\">\r\n            <table className=\"table\" cellSpacing=\"0\" cellPadding=\"0\">\r\n              <tr>\r\n                <td className=\"title\">\r\n                  <Label>合同审批单号</Label>\r\n                </td>\r\n                <td>{this.props.curItem && this.props.curItem.requestNo}</td>\r\n                <td className=\"title\">\r\n                  <Label>申请人</Label>\r\n                </td>\r\n                <td>{this.props.curItem && this.props.curItem.Author.Title}</td>\r\n                <td className=\"title\">\r\n                  <Label>合同主体</Label>\r\n                </td>\r\n                <td>{this.props.curItem && this.props.curItem.mainbody}</td>\r\n              </tr>\r\n              <tr>\r\n                <td className=\"title\">\r\n                  <Label>合同相对方</Label>\r\n                </td>\r\n                <td>\r\n                  {this.props.curItem && this.props.curItem.RelativeParty}\r\n                </td>\r\n                <td className=\"title\">\r\n                  <Label>合同类型</Label>\r\n                </td>\r\n                <td>{this.props.curItem && this.props.curItem.ContractType}</td>\r\n                <td className=\"title\">\r\n                  <Label>合同编号</Label>\r\n                </td>\r\n                <td>{this.props.curItem && this.props.curItem.ContractNo}</td>\r\n              </tr>\r\n              <tr>\r\n                <td className=\"title\">\r\n                  <Label>合同名称</Label>\r\n                </td>\r\n                <td>{this.props.curItem && this.props.curItem.Title}</td>\r\n                <td className=\"title\">\r\n                  <Label>合同标的和数量</Label>\r\n                </td>\r\n                <td>\r\n                  {this.props.curItem && this.props.curItem.ContractObject}\r\n                </td>\r\n                <td className=\"title\">\r\n                  <Label>合同金额</Label>\r\n                </td>\r\n                <td>\r\n                  {this.props.curItem\r\n                    ? this.props.curItem.Currency &&\r\n                      this.props.curItem.Currency === \"N/A\"\r\n                      ? this.props.curItem.Currency\r\n                      : this.props.curItem.Currency + this.props.curItem.Money\r\n                    : \"\"}\r\n                </td>\r\n              </tr>\r\n              <tr>\r\n                <td className=\"title\">\r\n                  <Label>付款方式</Label>\r\n                </td>\r\n                <td>{this.props.curItem && this.props.curItem.PayWay}</td>\r\n                <td className=\"title\">\r\n                  <Label>是否送审价中心审批</Label>\r\n                </td>\r\n                <td colSpan={3}>\r\n                  {this.props.curItem && this.props.curItem.NeedApproval\r\n                    ? \"是\"\r\n                    : \"否\"}\r\n                </td>\r\n              </tr>\r\n              <tr>\r\n                <td className=\"title\">\r\n                  <Label>备注</Label>\r\n                </td>\r\n                <td>{this.props.curItem && this.props.curItem.remarks}</td>\r\n                <td className=\"title\">\r\n                  <Label>附件</Label>\r\n                </td>\r\n                <td colSpan={3}>\r\n                  <Attachments\r\n                    docid={this.props.curItem && this.props.curItem.Id}\r\n                    deleteenable={false}\r\n                    defaultatts={\r\n                      this.props.curItem && this.props.curItem.AttachmentFiles\r\n                    }\r\n                  />\r\n                </td>\r\n              </tr>\r\n            </table>\r\n          </div>\r\n        </div>\r\n        <div className=\"ms-Grid-row\">\r\n          <div className=\"ms-Grid-col ms-sm12 ms-md12 ms-lg12\">\r\n            <CollapsePanel headerText={\"审批记录\"}>\r\n              <Apprhistory\r\n                contractitemid={this.props.curItem && this.props.curItem.Id}\r\n              />\r\n            </CollapsePanel>\r\n          </div>\r\n        </div>\r\n        <div className=\"ms-Grid-row\">\r\n          <div className=\"ms-Grid-col ms-sm12 ms-md12 ms-lg12\">\r\n            <fieldset>\r\n              <legend>\r\n                <Label>\r\n                  <h2>审批意见栏</h2>\r\n                </Label>\r\n              </legend>\r\n              <div>\r\n                审批结果\r\n                <span style={{ color: \"red\" }}>*</span>：\r\n                <input\r\n                  type=\"radio\"\r\n                  id=\"rst_ok\"\r\n                  name=\"rdo_result\"\r\n                  value=\"1\"\r\n                  onClick={() => {\r\n                    this.setState({ result: true });\r\n                  }}\r\n                />\r\n                <label htmlFor=\"rst_ok\">通过</label>\r\n                <input\r\n                  type=\"radio\"\r\n                  id=\"rst_no\"\r\n                  name=\"rdo_result\"\r\n                  value=\"0\"\r\n                  onClick={() => {\r\n                    this.setState({ result: false, sendtype: \"\" });\r\n                  }}\r\n                />\r\n                <label htmlFor=\"rst_no\">拒绝</label>\r\n                &nbsp;&nbsp;\r\n                <label\r\n                  style={{\r\n                    color: \"red\",\r\n                    display: this.state.result === undefined ? \"\" : \"none\"\r\n                  }}\r\n                >\r\n                  请选择是否通过\r\n                </label>{\" \"}\r\n              </div>\r\n\r\n              {this.props.curItem &&\r\n              this.props.curItem.status === \"2\" &&\r\n              this.state.result ? (\r\n                <div>\r\n                  寄取方式\r\n                  <span style={{ color: \"red\" }}>*</span>：\r\n                  <input\r\n                    type=\"radio\"\r\n                    id=\"rst_send0\"\r\n                    name=\"rdo_send\"\r\n                    checked={this.state.sendtype === \"请取回\"}\r\n                    value=\"请取回\"\r\n                    onClick={() => {\r\n                      this.setState({ sendtype: \"请取回\" });\r\n                    }}\r\n                  />\r\n                  <label htmlFor=\"rst_send0\">请取回</label>\r\n                  <input\r\n                    type=\"radio\"\r\n                    id=\"rst_send1\"\r\n                    name=\"rdo_send\"\r\n                    value=\"今天寄回\"\r\n                    checked={this.state.sendtype === \"今天寄回\"}\r\n                    onClick={() => {\r\n                      this.setState({ sendtype: \"今天寄回\" });\r\n                    }}\r\n                  />\r\n                  <label htmlFor=\"rst_send1\">今天寄回</label>\r\n                  <label\r\n                    style={{\r\n                      color: \"red\",\r\n                      marginLeft: \"20px\",\r\n                      display:\r\n                        !this.state.sendtype || this.state.sendtype === \"\"\r\n                          ? \"\"\r\n                          : \"none\"\r\n                    }}\r\n                  >\r\n                    请选择寄取方式\r\n                  </label>\r\n                </div>\r\n              ) : (\r\n                \"\"\r\n              )}\r\n              <div>\r\n                {`${\r\n                  this.props.curItem && this.props.curItem.status === \"1\"\r\n                    ? \"审价中心\"\r\n                    : \"律师\"\r\n                }意见`}\r\n                ：\r\n                <div>\r\n                  <ReactQuill\r\n                    ref={el => (this.quillRef = el)}\r\n                    defaultValue={this.state.description && \"\"}\r\n                    modules={this.modules()}\r\n                    formats={this.formats}\r\n                    onChange={this.updateContent}\r\n                  />\r\n                </div>\r\n              </div>\r\n              <div>\r\n                附件：\r\n                <div className=\"ms-Grid-row\">\r\n                  <div className=\"ms-Grid-col ms-sm12 ms-md6 ms-lg6\">\r\n                    <input\r\n                      type=\"file\"\r\n                      onChange={this.UploadFile}\r\n                      ref={obj => {\r\n                        this.FileUpload = obj;\r\n                      }}\r\n                    />\r\n                    <div style={{ color: \"Red\" }}>\r\n                      {this.state.uploadErrmsg}\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"ms-Grid-col ms-sm12 ms-md6 ms-lg6\">\r\n                    <Attachments\r\n                      docid={this.state.id ? this.state.id : 0}\r\n                      deleteenable={!this._isSubmitButtonHidden()}\r\n                      listName={WebConfig.AddrListName}\r\n                      defaultatts={\r\n                        this.state.AttachmentFiles\r\n                          ? this.state.AttachmentFiles\r\n                          : []\r\n                      }\r\n                      setAtts={this._onDeletedItems}\r\n                    />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div className=\"ms-Grid\">\r\n                <div className=\"ms-Grid-row\">\r\n                  <div className=\"ms-Grid-col ms-sm2 ms-md2 ms-lg2\">\r\n                    <Label>审批日期</Label>\r\n                  </div>\r\n                  <div className=\"ms-Grid-col ms-sm2 ms-md2 ms-lg2\">\r\n                    <Label>{moment(new Date()).format(\"YYYY/MM/DD\")}</Label>\r\n                  </div>\r\n                  <div className=\"ms-Grid-col ms-sm2 ms-md2 ms-lg2\">\r\n                    <Label>审批人</Label>\r\n                  </div>\r\n                  <div className=\"ms-Grid-col ms-sm6 ms-md6 ms-lg6\">\r\n                    <Label>\r\n                      {this.props.curItem && this.props.curUser.Title}\r\n                    </Label>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </fieldset>\r\n          </div>\r\n        </div>\r\n        <div className=\"ms-Grid-row\">\r\n          <div className=\"ms-Grid-col ms-sm12 ms-md12 ms-lg12\">\r\n            <div className=\"footerbtns\">{this._getButtons()}</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private _getButtons(): JSX.Element[] {\r\n    let buttons: JSX.Element[] = [];\r\n\r\n    if (this._isSubmitButtonHidden() === false) {\r\n      buttons.push(\r\n        <PrimaryButton\r\n          data-automation-id=\"test\"\r\n          text=\"提交\"\r\n          onClick={this._submit}\r\n        />\r\n      );\r\n    }\r\n    buttons.push(\r\n      <DefaultButton\r\n        data-automation-id=\"test2\"\r\n        text=\"关闭\"\r\n        onClick={() => {\r\n          window.location.href = WebConfig.InapprovalListPage;\r\n        }}\r\n      />\r\n    );\r\n    return buttons;\r\n  }\r\n\r\n  private _isSubmitButtonHidden(): boolean {\r\n    return false;\r\n  }\r\n  @autobind\r\n  private UploadFile(): void {\r\n    if (this.FileUpload.files.length > 0) {\r\n      this.setState({ uploadErrmsg: \"正在上传...\" });\r\n      if (this.state.id && this.state.id > 0) {\r\n        this.doUploadfile();\r\n      } else {\r\n        this.Save(() => {\r\n          const data: any = {\r\n            itemidId: this.props.curItem.Id,\r\n            Title: this.props.curItem.status === \"1\" ? \"审价中心\" : \"律师\",\r\n            result: this.state.result,\r\n            sendtype: this.state.sendtype,\r\n            submited: false,\r\n            description: this.state.description ? this.state.description : \"\"\r\n          };\r\n          sp.web.lists\r\n            .getByTitle(WebConfig.AddrListName)\r\n            .items.add(data)\r\n            .then(item => {\r\n              this.setState({ id: item.data.Id }, () => {\r\n                this.doUploadfile();\r\n              });\r\n            })\r\n            .catch(err => {\r\n              console.log(err);\r\n              alert(\"保存失败，请刷新后再试。\");\r\n            });\r\n        });\r\n      }\r\n    }\r\n  }\r\n  @autobind\r\n  private doUploadfile(): void {\r\n    let file: File = this.FileUpload.files[0];\r\n    const fileReader: FileReader = new FileReader();\r\n    let item: Item = sp.web.lists\r\n      .getByTitle(WebConfig.AddrListName)\r\n      .items.getById(this.state.id);\r\n    fileReader.onloadend = (event: Event) => {\r\n      let attdata: any = fileReader.result;\r\n      let subjoin: string = status === \"3\" ? \"_s\" : \"\";\r\n      let newfileName: string = GetFileRandName(file.name, subjoin);\r\n      item.attachmentFiles\r\n        .add(newfileName, attdata)\r\n        .then(v => {\r\n          // console.log(v);\r\n          let AttachmentFiles: any[] = [];\r\n          objectAssign(AttachmentFiles, this.state.AttachmentFiles);\r\n          if (!AttachmentFiles) {\r\n            AttachmentFiles = [];\r\n          }\r\n          // console.log(data.AttachmentFiles);\r\n          AttachmentFiles.push({\r\n            ServerRelativeUrl: v.data.ServerRelativeUrl,\r\n            FileName: v.data.FileName\r\n          });\r\n          this.FileUpload.value = \"\";\r\n          //  console.log(data.AttachmentFiles);\r\n          this.setState(\r\n            { AttachmentFiles: AttachmentFiles, uploadErrmsg: \"上传成功\" },\r\n            () => {\r\n              setTimeout(() => {\r\n                this.setState(() => ({ uploadErrmsg: \"\" }));\r\n              }, 500);\r\n            }\r\n          );\r\n          /*   isAdd\r\n            ? this.props.onAdded(data, false)\r\n            : this.props.onUpdated(data, false);*/\r\n        })\r\n        .catch(err => {\r\n          let errMsg: string = err.data\r\n            ? err.data.responseBody[\"odata.error\"].message.value\r\n            : err.message;\r\n          this.setState({ uploadErrmsg: \"上传失败:\" + errMsg });\r\n        });\r\n    };\r\n\r\n    fileReader.readAsArrayBuffer(file);\r\n  }\r\n  private Save(callBack: () => void): void {\r\n    let title: string = this.props.curItem.status === \"1\" ? \"审价中心\" : \"律师\";\r\n    sp.web.lists\r\n      .getByTitle(WebConfig.requestedItemsListName)\r\n      .items.getById(this.props.curItem.Id)\r\n      .get()\r\n      .then(reqitem => {\r\n        if (reqitem.status !== this.props.curItem.status) {\r\n          sp.web.lists\r\n            .getByTitle(WebConfig.AddrListName)\r\n            .items.filter(\r\n              \"submited eq 1 and itemidId eq \" +\r\n                this.props.curItem.Id +\r\n                \" and Title eq '\" +\r\n                encodeURIComponent(title) +\r\n                \"'\"\r\n            )\r\n            .orderBy(\"Modified\", false)\r\n            .top(1)\r\n            .select(\"*\", \"Author/Title\")\r\n            .expand(\"Author\")\r\n            .get()\r\n            .then(items => {\r\n              let msg: string = \"检测到申请状态有变更，请刷新。\";\r\n              if (items.length > 0) {\r\n                let appItem: any = items[0];\r\n                msg = `抱歉，该合同申请已被${title}${appItem.Author.Title}审批${\r\n                  appItem.result ? \"通过\" : \"驳回\"\r\n                },您不能重复处理。`;\r\n                alert(msg);\r\n              } else {\r\n                // alert(msg);\r\n                this.setState({ uploadErrmsg: msg });\r\n              }\r\n            });\r\n        } else {\r\n          callBack();\r\n        }\r\n      })\r\n      .catch(err => {\r\n        console.log(err);\r\n        alert(\"保存失败，请刷新后再试。\");\r\n      });\r\n  }\r\n  @autobind\r\n  private _onDeletedItems(items: any[]): void {\r\n    this.setState({\r\n      AttachmentFiles: items\r\n    });\r\n  }\r\n  @autobind\r\n  private _submit(): void {\r\n    // console.log(this.state.result);\r\n    if (this.state.result === undefined) {\r\n      return;\r\n    }\r\n    if (this.state.result && this.props.curItem.status === \"2\") {\r\n      if (this.state.sendtype === undefined || this.state.sendtype === \"\") {\r\n        return;\r\n      }\r\n    }\r\n    this.Save(() => {\r\n      const data: any = {\r\n        itemidId: this.props.curItem.Id,\r\n        Title: this.props.curItem.status === \"1\" ? \"审价中心\" : \"律师\",\r\n        result: this.state.result,\r\n        sendtype: this.state.sendtype,\r\n        submited: true,\r\n        description: this.state.description ? this.state.description : \"\"\r\n      };\r\n      //  console.log(data);\r\n      let applog: string = \"\";\r\n      if (\r\n        !this.props.curItem.applog ||\r\n        this.props.curItem.applog.indexOf(\",\") < 0\r\n      ) {\r\n        applog = \",\" + this.props.curUser.Id + \",\";\r\n      } else if (\r\n        this.props.curItem.applog.indexOf(\",\" + this.props.curUser.Id + \",\") < 0\r\n      ) {\r\n        applog = this.props.curItem.applog + this.props.curUser.Id + \",\";\r\n      }\r\n      let isPrice: boolean = true;\r\n      let pm: Promise<any> = null;\r\n      if (this.state.id && this.state.id > 0) {\r\n        pm = sp.web.lists\r\n          .getByTitle(WebConfig.AddrListName)\r\n          .items.getById(this.state.id)\r\n          .update(data);\r\n      } else {\r\n        pm = sp.web.lists.getByTitle(WebConfig.AddrListName).items.add(data);\r\n      }\r\n      pm.then(value => {\r\n        let status: string = \"\";\r\n        if (this.props.curItem.status === \"1\") {\r\n          status = data.result ? \"2\" : \"-1\";\r\n          isPrice = true;\r\n        } else {\r\n          status = data.result ? \"3\" : \"-2\";\r\n          isPrice = false;\r\n        }\r\n        let curItem: IItem = {} as IItem;\r\n        // objectAssign(curItem,this.props.curItem);\r\n        // curItem.status=status;\r\n        let ItemData: any = { status: status, applog: applog };\r\n        if (isPrice) {\r\n          ItemData.pricingcenterId = this.props.curUser.Id;\r\n        } else {\r\n          ItemData.lawyerId = this.props.curUser.Id;\r\n        }\r\n        sp.web.lists\r\n          .getByTitle(WebConfig.requestedItemsListName)\r\n          .items.getById(this.props.curItem.Id)\r\n          .update(ItemData)\r\n          .then(v2 => {\r\n            this.props.onUpdatedItem(\r\n              this.props.curItem,\r\n              status,\r\n              this.state.description && this.state.description.trim() !== \"\"\r\n                ? this.state.description\r\n                : \"\",\r\n              this.state.sendtype\r\n            );\r\n          });\r\n      });\r\n    });\r\n  }\r\n  @autobind\r\n  private updateContent(newContent) {\r\n    this.setState({\r\n      description: newContent\r\n    });\r\n    // console.log(newContent);\r\n  }\r\n  @autobind\r\n  private onChange(evt) {\r\n    // console.log(\"onChange fired with event info: \", evt);\r\n    // var newContent = evt.editor.getData();\r\n    // this.setState({\r\n    //  description: newContent\r\n    // });\r\n  }\r\n  @autobind\r\n  private onBlur(evt) {\r\n    // console.log(\"onBlur event called with event info: \", evt);\r\n  }\r\n  @autobind\r\n  private afterPaste(evt) {\r\n    // console.log(\"afterPaste event called with event info: \", evt);\r\n  }\r\n  private getIcons(): string[] {\r\n    return [\r\n      \"source | undo redo | bold italic underline strikethrough fontborder emphasis | \",\r\n      \"paragraph fontfamily fontsize | superscript subscript | \",\r\n      \"forecolor backcolor | removeformat | insertorderedlist insertunorderedlist | selectall | \",\r\n      \"cleardoc  | indent outdent | justifyleft justifycenter justifyright | touppercase tolowercase | \",\r\n      \"horizontal date time  | image spechars | inserttable\"\r\n    ];\r\n  }\r\n  @autobind\r\n  private uploadImageCallback(value: any): void {\r\n    console.log(value);\r\n  }\r\n  private modules(): any {\r\n    return {\r\n      toolbar: {\r\n        container: [\r\n          [{ header: [1, 2, false] }],\r\n          [\"bold\", \"italic\", \"underline\", \"strike\", \"blockquote\"],\r\n          [\r\n            { list: \"ordered\" },\r\n            { list: \"bullet\" },\r\n            { indent: \"-1\" },\r\n            { indent: \"+1\" }\r\n          ],\r\n          [\"link\", \"image\"],\r\n          [\"clean\"]\r\n        ]\r\n      }\r\n    };\r\n  }\r\n\r\n  public componentDidMount(): void {\r\n    // tslint:disable-next-line:typedef\r\n    const toolbar = this.quillRef.getEditor().getModule(\"toolbar\");\r\n\r\n    toolbar.addHandler(\"image\", () => {\r\n      let fileInput: any = this.quillRef.editor.container.querySelector(\r\n        \"input.ql-image[type=file]\"\r\n      );\r\n      if (fileInput == null) {\r\n        fileInput = document.createElement(\"input\");\r\n        fileInput.setAttribute(\"type\", \"file\");\r\n        fileInput.setAttribute(\"style\", \"display:none\");\r\n        fileInput.setAttribute(\r\n          \"accept\",\r\n          \"image/png, image/gif, image/jpeg, image/bmp, image/x-icon\"\r\n        );\r\n        fileInput.classList.add(\"ql-image\");\r\n        fileInput.addEventListener(\"change\", () => {\r\n          if (fileInput.files != null && fileInput.files[0] != null) {\r\n            this._douploadfile(fileInput);\r\n          }\r\n        });\r\n        this.quillRef.editor.container.appendChild(fileInput);\r\n      }\r\n      fileInput.click();\r\n    });\r\n  }\r\n  private _douploadfile(fileInput: any): void {\r\n    const file: File = fileInput.files[0] as File;\r\n    let reader: any = new FileReader();\r\n    reader.onloadend = e => {\r\n      sp.web.lists\r\n        .getByTitle(WebConfig.AddrListName)\r\n        .rootFolder.files.add(file.name, reader.result)\r\n        .then(v => {\r\n          let data: any = {\r\n            imgUrl: WebConfig.hosturl + v.data.ServerRelativeUrl,\r\n            FileName: v.data.FileName\r\n          };\r\n          let range: any = this.quillRef.editor.getSelection(true);\r\n          this.quillRef.editor.updateContents(\r\n            new Delta()\r\n              .retain(range.index)\r\n              .delete(range.length)\r\n              .insert({ image: data.imgUrl }),\r\n            Quill.sources.USER\r\n          );\r\n          this.quillRef.editor.setSelection(\r\n            range.index + 1,\r\n            Quill.sources.SILENT\r\n          );\r\n          fileInput.value = \"\";\r\n        });\r\n    };\r\n    reader.readAsArrayBuffer(file);\r\n  }\r\n}\r\n"],"sourceRoot":"..\\..\\..\\..\\src"}