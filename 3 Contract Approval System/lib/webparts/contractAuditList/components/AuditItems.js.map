{"version":3,"sources":["../../src/webparts/contractAuditList/components/AuditItems.tsx"],"names":[],"mappings":"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","file":"webparts/contractAuditList/components/AuditItems.js","sourcesContent":["import React = require(\"react\");\r\nimport { IAuditItemsState } from \"./IAuditItemsState\";\r\nimport * as ReactQuill from \"react-quill\";\r\nimport * as QuillNamespace from \"quill\";\r\nlet Quill: any = QuillNamespace;\r\nconst Delta = Quill.import(\"delta\");\r\nimport \"react-quill/dist/quill.snow.css\";\r\nimport { sp } from \"@pnp/sp\";\r\nimport \"@pnp/polyfill-ie11\";\r\nimport { WebConfig } from \"../../ComComponents/webconfig\";\r\nimport { Label } from \"office-ui-fabric-react/lib/Label\";\r\nimport { PrimaryButton } from \"office-ui-fabric-react/lib/Button\";\r\nimport { autobind } from \"office-ui-fabric-react/lib/Utilities\";\r\n// import emitter from \"../../ComComponents/ev\";\r\nexport class AuditItems extends React.Component<any, IAuditItemsState> {\r\n  private quillRef: any;\r\n\r\n  private formats: any[] = [\r\n    \"header\",\r\n    \"bold\",\r\n    \"italic\",\r\n    \"underline\",\r\n    \"strike\",\r\n    \"blockquote\",\r\n    \"list\",\r\n    \"bullet\",\r\n    \"indent\",\r\n    \"link\",\r\n    \"image\"\r\n  ];\r\n  // eventEmitter: any;\r\n  constructor(props: any) {\r\n    super(props);\r\n    this.state = {\r\n      description: \"\",\r\n      result: undefined,\r\n      isLaywer: false,\r\n      sendtype: \"\"\r\n    };\r\n  }\r\n  public render(): React.ReactElement<any> {\r\n    return (\r\n      <div className=\"ms-Grid\">\r\n        <div className=\"ms-Grid-row\">\r\n          <div className=\"ms-Grid-col ms-sm12 ms-md12 ms-lg12\">\r\n            <table style={{ width: \"90%\", margin: \"0 auto\" }}>\r\n              <tr>\r\n                <td style={{ width: \"100px\" }}>\r\n                  <h3>已选择项目:</h3>\r\n                </td>\r\n                <td>\r\n                  <ol>\r\n                    {this.props.curItems.map(item => {\r\n                      return (\r\n                        <li style={{ margin: \"0px 20px\" }}>\r\n                          <a\r\n                            href={`${WebConfig.ApprovalPage}?request=${\r\n                              item.Id\r\n                            }`}\r\n                            target=\"_blank\"\r\n                          >\r\n                            {item.requestNo}\r\n                          </a>\r\n                          :{item.Title}\r\n                        </li>\r\n                      );\r\n                    })}\r\n                  </ol>\r\n                </td>\r\n              </tr>\r\n            </table>\r\n          </div>\r\n        </div>\r\n        <div className=\"ms-Grid-row\">\r\n          <div className=\"ms-Grid-col ms-sm12 ms-md12 ms-lg12\">\r\n            <table style={{ width: \"90%\", margin: \"0 auto\" }}>\r\n              <tr>\r\n                <td>\r\n                  <h2>审批意见栏</h2>\r\n                </td>\r\n              </tr>\r\n              <tr>\r\n                <td>\r\n                  <div>\r\n                    审批结果\r\n                    <span style={{ color: \"red\" }}>*</span>：\r\n                    <input\r\n                      type=\"radio\"\r\n                      id=\"rst_ok\"\r\n                      name=\"rdo_result\"\r\n                      value=\"1\"\r\n                      onClick={() => {\r\n                        this.setState({ result: true });\r\n                        // console.log(this.props.isLaywer);\r\n                      }}\r\n                    />\r\n                    <label htmlFor=\"rst_ok\">通过</label>\r\n                    <input\r\n                      type=\"radio\"\r\n                      id=\"rst_no\"\r\n                      name=\"rdo_result\"\r\n                      value=\"0\"\r\n                      onClick={() => {\r\n                        this.setState({ result: false, sendtype: \"\" });\r\n                        // console.log(this.props.isLaywer);\r\n                      }}\r\n                    />\r\n                    <label htmlFor=\"rst_no\">拒绝</label>\r\n                    &nbsp;&nbsp;\r\n                    <label\r\n                      style={{\r\n                        color: \"red\",\r\n                        display: this.state.result === undefined ? \"\" : \"none\"\r\n                      }}\r\n                    >\r\n                      请选择是否通过\r\n                    </label>{\" \"}\r\n                  </div>\r\n                  {this.state.result && this.props.isLaywer ? (\r\n                    <div>\r\n                      寄送方式\r\n                      <span style={{ color: \"red\" }}>*</span>：\r\n                      <input\r\n                        type=\"radio\"\r\n                        id=\"rst_send0\"\r\n                        name=\"rdo_send\"\r\n                        checked={this.state.sendtype === \"请取回\"}\r\n                        value=\"请取回\"\r\n                        onClick={() => {\r\n                          this.setState({ sendtype: \"请取回\" });\r\n                        }}\r\n                      />\r\n                      <label htmlFor=\"rst_send0\">请取回</label>\r\n                      <input\r\n                        type=\"radio\"\r\n                        id=\"rst_send1\"\r\n                        name=\"rdo_send\"\r\n                        value=\"今天寄回\"\r\n                        checked={this.state.sendtype === \"今天寄回\"}\r\n                        onClick={() => {\r\n                          this.setState({ sendtype: \"今天寄回\" });\r\n                        }}\r\n                      />\r\n                      <label htmlFor=\"rst_send1\">今天寄回</label>\r\n                      <label\r\n                        style={{\r\n                          color: \"red\",\r\n                          marginLeft: \"20px\",\r\n                          display:\r\n                            !this.state.sendtype || this.state.sendtype === \"\"\r\n                              ? \"\"\r\n                              : \"none\"\r\n                        }}\r\n                      >\r\n                        请选择寄取方式\r\n                      </label>\r\n                    </div>\r\n                  ) : (\r\n                    \"\"\r\n                  )}\r\n                  <div>\r\n                    审批意见：\r\n                    <div>\r\n                      <ReactQuill\r\n                        ref={el => (this.quillRef = el)}\r\n                        defaultValue={this.state.description && \"\"}\r\n                        modules={this.modules()}\r\n                        formats={this.formats}\r\n                        onChange={this.updateContent}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"ms-Grid\">\r\n                    <div className=\"ms-Grid-row\">\r\n                      <div className=\"ms-Grid-col ms-sm2 ms-md2 ms-lg2\">\r\n                        <Label>审批日期</Label>\r\n                      </div>\r\n                      <div className=\"ms-Grid-col ms-sm2 ms-md2 ms-lg2\">\r\n                        <Label>{new Date().toLocaleDateString()}</Label>\r\n                      </div>\r\n                      <div className=\"ms-Grid-col ms-sm2 ms-md2 ms-lg2\">\r\n                        <Label>审批人</Label>\r\n                      </div>\r\n                      <div className=\"ms-Grid-col ms-sm6 ms-md6 ms-lg6\">\r\n                        <Label>{this.props.curUser.Title}</Label>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </td>\r\n              </tr>\r\n            </table>\r\n          </div>\r\n        </div>\r\n        <div className=\"ms-Grid-row\">\r\n          <div className=\"ms-Grid-col ms-sm12 ms-md12 ms-lg12\">\r\n            <div className=\"ms-textAlignCenter\">{this._getButtons()}</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n  private modules(): any {\r\n    return {\r\n      toolbar: {\r\n        container: [\r\n          [{ header: [1, 2, false] }],\r\n          [\"bold\", \"italic\", \"underline\", \"strike\", \"blockquote\"],\r\n          [\r\n            { list: \"ordered\" },\r\n            { list: \"bullet\" },\r\n            { indent: \"-1\" },\r\n            { indent: \"+1\" }\r\n          ],\r\n          [\"link\", \"image\"],\r\n          [\"clean\"]\r\n        ]\r\n      }\r\n    };\r\n  }\r\n  @autobind\r\n  private updateContent(newContent: string): void {\r\n    this.setState({\r\n      description: newContent\r\n    });\r\n    // console.log(newContent);\r\n  }\r\n  private _getButtons(): JSX.Element[] {\r\n    let buttons: JSX.Element[] = [];\r\n\r\n    if (this._isSubmitButtonHidden() === false) {\r\n      buttons.push(\r\n        <PrimaryButton\r\n          data-automation-id=\"test\"\r\n          text=\"提交\"\r\n          onClick={this._submit}\r\n        />\r\n      );\r\n    }\r\n    return buttons;\r\n  }\r\n  private _isSubmitButtonHidden(): boolean {\r\n    return false;\r\n  }\r\n  public componentDidMount(): void {\r\n    /*this.eventEmitter = emitter.addListener(\"setIsLaywer\",(states)=> {\r\n      console.log(states);\r\n      this.setState({\r\n        isLaywer:states.isWaitforLaywer\r\n      });\r\n  });*/\r\n    // tslint:disable-next-line:typedef\r\n    const toolbar = this.quillRef.getEditor().getModule(\"toolbar\");\r\n\r\n    toolbar.addHandler(\"image\", () => {\r\n      let fileInput: any = this.quillRef.editor.container.querySelector(\r\n        \"input.ql-image[type=file]\"\r\n      );\r\n      if (fileInput == null) {\r\n        fileInput = document.createElement(\"input\");\r\n        fileInput.setAttribute(\"type\", \"file\");\r\n        fileInput.setAttribute(\"style\", \"display:none\");\r\n        fileInput.setAttribute(\r\n          \"accept\",\r\n          \"image/png, image/gif, image/jpeg, image/bmp, image/x-icon\"\r\n        );\r\n        fileInput.classList.add(\"ql-image\");\r\n        fileInput.addEventListener(\"change\", () => {\r\n          if (fileInput.files != null && fileInput.files[0] != null) {\r\n            this._douploadfile(fileInput);\r\n          }\r\n        });\r\n        this.quillRef.editor.container.appendChild(fileInput);\r\n      }\r\n      fileInput.click();\r\n    });\r\n  }\r\n  // 组件销毁前移除事件监听\r\n  public componentWillUnmount(): void {\r\n    // console.log(\"removeListener\");\r\n    //  emitter.removeListener(\"setIsLaywer\",this.eventEmitter);\r\n  }\r\n  public componentWillReceiveProps(nextprop: any): void {\r\n    // console.log(nextprop);\r\n  }\r\n  @autobind\r\n  private _submit(): void {\r\n    // console.log(this.state.result);\r\n    if (this.state.result === undefined) {\r\n      return;\r\n    }\r\n    if (this.state.result === false && this.state.description.trim() === \"\") {\r\n      alert(\"请填写驳回原因！\");\r\n      return;\r\n    }\r\n    if (this.state.result && this.props.isLaywer) {\r\n      if (this.state.sendtype === undefined || this.state.sendtype === \"\") {\r\n        return;\r\n      }\r\n    }\r\n    // objectAssign(curItem,this.props.curItem);\r\n    // curItem.status=status;\r\n    const itemcount: number = this.props.curItems.length;\r\n    this.props.curItems.map((curItem, index) => {\r\n      const data: any = {\r\n        itemidId: curItem.Id,\r\n        Title: curItem.status === \"1\" ? \"审价中心\" : \"律师\",\r\n        result: this.state.result,\r\n        sendtype: this.props.isLaywer ? this.state.sendtype : \"\",\r\n        description: this.state.description ? this.state.description : \"\"\r\n      };\r\n      let applog: string = \"\";\r\n      if (!curItem.applog || curItem.applog.indexOf(\",\") < 0) {\r\n        applog = \",\" + this.props.curUser.Id + \",\";\r\n      } else if (\r\n        curItem.applog.indexOf(\",\" + this.props.curUser.Id + \",\") < 0\r\n      ) {\r\n        applog = curItem.applog + this.props.curUser.Id + \",\";\r\n      }\r\n      let isPrice: boolean = true;\r\n      sp.web.lists\r\n        .getByTitle(WebConfig.AddrListName)\r\n        .items.add(data)\r\n        .then(value => {\r\n          let status: string = \"\";\r\n          if (curItem.status === \"1\") {\r\n            isPrice = true;\r\n            status = data.result ? \"2\" : \"-1\";\r\n          } else {\r\n            isPrice = false;\r\n            status = data.result ? \"3\" : \"-2\";\r\n          }\r\n          let ItemData: any = { status: status, applog: applog };\r\n          if (isPrice) {\r\n            ItemData.pricingcenterId = this.props.curUser.Id;\r\n          } else {\r\n            ItemData.lawyerId = this.props.curUser.Id;\r\n          }\r\n          sp.web.lists\r\n            .getByTitle(WebConfig.requestedItemsListName)\r\n            .items.getById(curItem.Id)\r\n            .update(ItemData)\r\n            .then(v2 => {\r\n              this.props.onUpdatedItem(\r\n                curItem,\r\n                status,\r\n                this.state.description ? this.state.description : \"\",\r\n                this.state.sendtype,\r\n                itemcount\r\n              );\r\n            });\r\n        });\r\n    });\r\n  }\r\n  private _douploadfile(fileInput: any): void {\r\n    const file: File = fileInput.files[0] as File;\r\n    let reader: any = new FileReader();\r\n    reader.onloadend = e => {\r\n      sp.web.lists\r\n        .getByTitle(WebConfig.AddrListName)\r\n        .rootFolder.files.add(file.name, reader.result)\r\n        .then(v => {\r\n          let data: any = {\r\n            imgUrl: WebConfig.hosturl + v.data.ServerRelativeUrl,\r\n            FileName: v.data.FileName\r\n          };\r\n          let range: any = this.quillRef.editor.getSelection(true);\r\n          this.quillRef.editor.updateContents(\r\n            new Delta()\r\n              .retain(range.index)\r\n              .delete(range.length)\r\n              .insert({ image: data.imgUrl }),\r\n            Quill.sources.USER\r\n          );\r\n          this.quillRef.editor.setSelection(\r\n            range.index + 1,\r\n            Quill.sources.SILENT\r\n          );\r\n          fileInput.value = \"\";\r\n        });\r\n    };\r\n    reader.readAsArrayBuffer(file);\r\n  }\r\n}\r\n"],"sourceRoot":"..\\..\\..\\..\\src"}