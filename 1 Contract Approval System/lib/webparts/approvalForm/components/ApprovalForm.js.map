{"version":3,"sources":["../../src/webparts/approvalForm/components/ApprovalForm.tsx"],"names":[],"mappings":"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","file":"webparts/approvalForm/components/ApprovalForm.js","sourcesContent":["import * as React from \"react\";\r\nimport styles from \"./ApprovalForm.module.scss\";\r\nimport { IApprovalFormProps } from \"./IApprovalFormProps\";\r\n\r\nimport { IApprovalFormState } from \"./IApprovalFormState\";\r\nimport { AppItemForm } from \"./AppItemForm\";\r\nimport { statusDesc, IItem } from \"../../ComComponents/interfaces/IItem\";\r\nimport { sp } from \"@pnp/sp\";\r\nimport \"@pnp/polyfill-ie11\";\r\nimport { IColumnField } from \"../../ComComponents/interfaces/IColumnField\";\r\nimport { String } from \"typescript-string-operations\";\r\nimport { WebConfig, CurrentUrl } from \"../../ComComponents/webconfig\";\r\nimport { EmailUtil } from \"../../ComComponents/Email/EmailUtil\";\r\nimport { Label } from \"office-ui-fabric-react/lib/Label\";\r\nimport { autobind } from \"office-ui-fabric-react/lib/Utilities\";\r\nimport * as objectAssign from \"object-assign\";\r\nexport default class ApprovalForm extends React.Component<\r\n  IApprovalFormProps,\r\n  IApprovalFormState\r\n> {\r\n  constructor(props: any) {\r\n    super(props);\r\n    this.state = {\r\n      requestedItemsListFields: [\r\n        {\r\n          ariaLabel: \"Id\",\r\n          Name: \"Id\",\r\n          maxWidth: 0\r\n        },\r\n        {\r\n          ariaLabel: \"合同类型\",\r\n          Name: \"ContractType\"\r\n        },\r\n        {\r\n          ariaLabel: \"合同编号\",\r\n          Name: \"ContractNo\"\r\n        },\r\n        {\r\n          ariaLabel: \"合同名称\",\r\n          Name: \"Title\"\r\n        },\r\n        {\r\n          ariaLabel: \"合同标的和数量\",\r\n          Name: \"ContractObject\"\r\n        },\r\n        {\r\n          ariaLabel: \"合同金额\",\r\n          Name: \"MoneyText\"\r\n        },\r\n        {\r\n          ariaLabel: \"付款方式\",\r\n          Name: \"PayWay\"\r\n        },\r\n        {\r\n          ariaLabel: \"备注\",\r\n          Name: \"remarks\"\r\n        },\r\n        {\r\n          ariaLabel: \"附件\",\r\n          Type: \"linkArray\",\r\n          Name: \"AttachmentFiles\"\r\n        },\r\n        {\r\n          ariaLabel: \"是否送审价中心审批\",\r\n          Name: \"NeedApproval\"\r\n        },\r\n        {\r\n          ariaLabel: \"状态\",\r\n          Name: \"statusDesc\"\r\n        }\r\n      ] as IColumnField[],\r\n      curUser: null,\r\n      curItem: null\r\n    };\r\n    // injectCss();\r\n  }\r\n  public render(): React.ReactElement<IApprovalFormProps> {\r\n    return (\r\n      <div className={styles.approvalForm}>\r\n        <div className={styles.container}>\r\n          <div className=\"ms-Grid\">\r\n            <div className=\"ms-Grid-row\">\r\n              <div className=\"ms-Grid-col ms-sm12 ms-md12 ms-lg12\">\r\n                <div\r\n                  className={styles.mstbheader}\r\n                  style={{ width: \"100%\", textAlign: \"center\" }}\r\n                >\r\n                  <h2>合同审批表</h2>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"ms-Grid-row\">\r\n              <div className=\"ms-Grid-col ms-sm12 ms-md6 ms-lg4\">\r\n                <div className=\"ms-Dropdown-container\">\r\n                  <label className={styles.mslable}>申请人</label>\r\n                  <div\r\n                    aria-expanded=\"false\"\r\n                    aria-live=\"assertive\"\r\n                    aria-disabled=\"true\"\r\n                    className=\"ms-Dropdown root_44853ebf\"\r\n                  >\r\n                    <Label>\r\n                      {this.state.curItem && this.state.curItem.Author\r\n                        ? this.state.curItem.Author.Title\r\n                        : \"\"}\r\n                    </Label>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div className=\"ms-Grid-col ms-sm12 ms-md6 ms-lg4\">\r\n                <div className=\"ms-Dropdown-container\">\r\n                  <label className={styles.mslable}>合同主体</label>\r\n                  <div\r\n                    aria-expanded=\"false\"\r\n                    aria-live=\"assertive\"\r\n                    aria-disabled=\"true\"\r\n                    className=\"ms-Dropdown root_44853ebf\"\r\n                  >\r\n                    <Label>\r\n                      {this.state.curItem && this.state.curItem.mainbody\r\n                        ? this.state.curItem.mainbody\r\n                        : \"\"}\r\n                    </Label>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div className=\"ms-Grid-col ms-sm12 ms-md6 ms-lg4\">\r\n                <div className=\"ms-Dropdown-container\">\r\n                  <label className={styles.mslable}>状态</label>\r\n                  <div\r\n                    aria-expanded=\"false\"\r\n                    aria-live=\"assertive\"\r\n                    aria-disabled=\"true\"\r\n                    className=\"ms-Dropdown root_44853ebf\"\r\n                  >\r\n                    <Label disabled={true}>\r\n                      {this.state.curItem\r\n                        ? this.state.curItem.statusDesc\r\n                        : \"New Request\"}\r\n                    </Label>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"ms-Grid-row\">\r\n              <div className=\"ms-Grid-col ms-sm12 ms-md6 ms-lg12\">\r\n                <div className=\"ms-Dropdown-container\">\r\n                  <label className={styles.mslable}>合同相对方</label>\r\n                  <div\r\n                    aria-expanded=\"false\"\r\n                    aria-live=\"assertive\"\r\n                    aria-disabled=\"true\"\r\n                    className=\"ms-Dropdown root_44853ebf\"\r\n                  >\r\n                    <Label>\r\n                      {this.state.curItem && this.state.curItem.RelativeParty\r\n                        ? this.state.curItem.RelativeParty\r\n                        : \"\"}\r\n                    </Label>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <AppItemForm\r\n              {...this.props}\r\n              curItem={this.state.curItem}\r\n              curUser={this.state.curUser}\r\n              onUpdatedItem={this._setItemResult}\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  @autobind\r\n  private _setItemResult(\r\n    item: IItem,\r\n    status: string,\r\n    comments: string,\r\n    sendtype: string\r\n  ): void {\r\n    let data: IItem = {} as IItem;\r\n    objectAssign(data, this.state.curItem);\r\n\r\n    let state: string = \"In approval\";\r\n    let allRejected: boolean = true;\r\n    let anyRejected: boolean = false;\r\n    let allPassed: boolean = true;\r\n\r\n    if (data.status === \"1\") {\r\n      const resultTitle: string = status === \"-1\" ? \"驳回\" : \"通过\";\r\n      EmailUtil.SendEmailbyId(\r\n        data.AuthorId,\r\n        String.Format(\r\n          WebConfig.EmailResultTemplate.body,\r\n          data.Title,\r\n          data.requestNo,\r\n          \"审价中心\",\r\n          resultTitle,\r\n          comments && comments !== \"\" ? `<p>审批意见：${comments}</p>` : \"\",\r\n          this._getmyctrlistlink()\r\n        ),\r\n        String.Format(\r\n          WebConfig.EmailResultTemplate.subject,\r\n          data.Title,\r\n          data.requestNo,\r\n          \"审价中心\",\r\n          resultTitle\r\n        )\r\n      );\r\n      if (status === \"2\") {\r\n        EmailUtil.SendEmailbyId(\r\n          data.lawyerId,\r\n          String.Format(\r\n            WebConfig.EmailToLawyerTemplate.body,\r\n            EmailUtil.getsystemlink(),\r\n            data.ContractType + \":\" + data.Title,\r\n            data.requestNo\r\n          ),\r\n          String.Format(\r\n            WebConfig.EmailToLawyerTemplate.subject,\r\n            data.Author.Title,\r\n            data.ContractType + \":\" + data.Title\r\n          )\r\n        );\r\n      }\r\n    } else if (data.status === \"2\") {\r\n      const resultTitle: string = status === \"-2\" ? \"驳回\" : \"通过!\" + sendtype;\r\n      EmailUtil.SendEmailbyId(\r\n        data.AuthorId,\r\n        String.Format(\r\n          WebConfig.EmailResultTemplate.body,\r\n          data.Title,\r\n          data.requestNo,\r\n          \"律师\",\r\n          resultTitle,\r\n          comments && comments.trim() !== \"\"\r\n            ? `<p>审批意见：${comments}</p>`\r\n            : \"\",\r\n          this._getmyctrlistlink()\r\n        ),\r\n        String.Format(\r\n          WebConfig.EmailResultTemplate.subject,\r\n          data.Title,\r\n          data.requestNo,\r\n          \"律师\",\r\n          resultTitle\r\n        )\r\n      );\r\n    }\r\n    data.status = status;\r\n    data.statusDesc = statusDesc[status];\r\n    this.setState({ curItem: data });\r\n    document.location.href = WebConfig.InapprovalListPage;\r\n  }\r\n\r\n  private _getmyctrlistlink(): string {\r\n    let url: string = CurrentUrl;\r\n    url =\r\n      url.substr(0, url.lastIndexOf(\"/\") + 1) + WebConfig.CreatedByMeListPage;\r\n    return `<a href=${url}>系统</a>`;\r\n  }\r\n  public componentDidMount(): void {\r\n    sp.web.currentUser\r\n      .get()\r\n      .then(result => {\r\n        this.setState({\r\n          curUser: result\r\n        });\r\n        let requestId: number = parseInt(this.props.id, 10);\r\n        if (isNaN(requestId)) {\r\n          //  window.location.href=\"../\";\r\n          return;\r\n        } else {\r\n          const filedNames: string[] = this.state.requestedItemsListFields.map(\r\n            d => {\r\n              return d.Name;\r\n            }\r\n          );\r\n          sp.web.lists\r\n            .getByTitle(WebConfig.requestedItemsListName)\r\n            .items.getById(requestId)\r\n            .select(\r\n              \"*\",\r\n              \"Author/Title\",\r\n              \"ContractType/Title\",\r\n              \"AttachmentFiles\",\r\n              \"lawyer/Title\",\r\n              \"pricingcenter/Title\"\r\n            )\r\n            .expand(\r\n              \"Author\",\r\n              \"ContractType\",\r\n              \"AttachmentFiles\",\r\n              \"lawyer/Id\",\r\n              \"pricingcenter/Id\"\r\n            )\r\n            .get()\r\n            .then(item => {\r\n              //  console.log(item);\r\n              sp.web.lists\r\n                .getByTitle(WebConfig.contractTypeListName)\r\n                .items.getById(item.ContractTypeId)\r\n                .get()\r\n                .then(confg => {\r\n                  let HasAuthority: boolean = false;\r\n                  if (item.status === \"1\") {\r\n                    if (\r\n                      item.pricingcenterId === result.Id ||\r\n                      confg.pricecenterId === result.Id ||\r\n                      confg.otherpricecentersId.indexOf(result.Id) >= 0\r\n                    ) {\r\n                      HasAuthority = true;\r\n                    }\r\n                  } else if (item.status === \"2\") {\r\n                    if (\r\n                      item.lawyerId === result.Id ||\r\n                      confg.laywerId === result.Id ||\r\n                      confg.otherlawyersId.indexOf(result.Id) >= 0\r\n                    ) {\r\n                      HasAuthority = true;\r\n                    }\r\n                  }\r\n                  if (!HasAuthority) {\r\n                    document.location.href = WebConfig.InapprovalListPage;\r\n                    return;\r\n                  }\r\n                  let curLawyer: any[] = [];\r\n                  if (item.lawyer) {\r\n                    curLawyer.push({\r\n                      title: item.lawyer.Title,\r\n                      text: item.lawyer.Title,\r\n                      key: item.lawyerId\r\n                    });\r\n                  }\r\n\r\n                  let curPricingcenter: any[] = [];\r\n                  if (item.pricingcenter) {\r\n                    curPricingcenter.push({\r\n                      title: item.pricingcenter.Title,\r\n                      text: item.pricingcenter.Title,\r\n                      key: item.pricingcenterId\r\n                    });\r\n                  }\r\n                  let itemdata: any = {\r\n                    Id: item.Id,\r\n                    ContractNo: item.ContractNo,\r\n                    Title: item.Title,\r\n                    ContractType: item.ContractType.Title,\r\n                    ContractTypeId: item.ContractTypeId,\r\n                    ContractObject: item.ContractObject,\r\n                    MoneyText:\r\n                      item.Currency === \"N/A\"\r\n                        ? item.Currency\r\n                        : `${item.Currency}${item.Money}`,\r\n                    Money: item.Money,\r\n                    Currency: item.Currency,\r\n                    NeedApproval: item.NeedApproval,\r\n                    PayWay: item.PayWay,\r\n                    status: item.status,\r\n                    statusDesc: statusDesc[item.status],\r\n                    Lawyer: curLawyer,\r\n                    Pricingcenter: curPricingcenter,\r\n                    lawyerId: item.lawyerId,\r\n                    pricingcenterId: item.pricingcenterId,\r\n                    remarks: item.remarks,\r\n                    requestNo: item.requestNo,\r\n                    CurrentHandler: item.CurrentHandler,\r\n                    AuthorId: item.AuthorId,\r\n                    mainbody: item.mainbody,\r\n                    Author: item.Author,\r\n                    RelativeParty: item.mainbody,\r\n                    FactoryDept: item.FactoryDept,\r\n                    AttachmentFiles: item.AttachmentFiles.map(fileinfo => {\r\n                      return {\r\n                        ServerRelativeUrl: fileinfo.ServerRelativeUrl,\r\n                        FileName: fileinfo.FileName\r\n                      };\r\n                    })\r\n                  };\r\n                  this.setState({ curItem: itemdata }, () => {\r\n                    //    console.log(this.state.curItem);\r\n                  });\r\n                })\r\n                .catch((error: any) => {\r\n                  console.log(error);\r\n                });\r\n            })\r\n            .catch((error: any) => {\r\n              console.log(error);\r\n            });\r\n        }\r\n      })\r\n      .catch((error: any) => {\r\n        console.log(error);\r\n      });\r\n  }\r\n}\r\n"],"sourceRoot":"..\\..\\..\\..\\src"}