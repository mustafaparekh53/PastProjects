{"version":3,"sources":["../../src/webparts/contractForm/components/ContractForm.tsx"],"names":[],"mappings":"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","file":"webparts/contractForm/components/ContractForm.js","sourcesContent":["import * as React from \"react\";\r\nimport styles from \"./ContractForm.module.scss\";\r\nimport { IContractFormProps, RequestFormMode } from \"./IContractFormProps\";\r\nimport { IRequestFormState } from \"./IRequestFormState\";\r\nimport { sp, ItemAddResult, Web, ItemUpdateResult } from \"@pnp/sp\";\r\nimport \"@pnp/polyfill-ie11\";\r\nimport contractutil from \"./contractutil\";\r\n\r\nimport Modal from \"office-ui-fabric-react/lib/Modal\";\r\nimport CpsItemForm from \"./ContractItemEditForm/CpsItemForm\";\r\nimport UxpList from \"../../ComComponents/UxpList/UxpList\";\r\nimport { IColumnField } from \"../../ComComponents/interfaces/IColumnField\";\r\nimport { IRequest } from \"../../ComComponents/interfaces/IRequest\";\r\nimport { IItem, statusDesc } from \"../../ComComponents/interfaces/IItem\";\r\nimport { IContractSubject } from \"../../ComComponents/interfaces/IContractSubject\";\r\n\r\nimport { WebConfig } from \"../../ComComponents/webconfig\";\r\nimport { Button, PrimaryButton } from \"office-ui-fabric-react/lib/Button\";\r\nimport { SelectionMode } from \"office-ui-fabric-react/lib/DetailsList\";\r\nimport { Dropdown, IDropdownOption } from \"office-ui-fabric-react/lib/Dropdown\";\r\nimport { TextField } from \"office-ui-fabric-react/lib/TextField\";\r\nimport { autobind } from \"office-ui-fabric-react/lib/Utilities\";\r\nimport { Label } from \"office-ui-fabric-react/lib/Label\";\r\n// import { injectCss } from \"../../ComComponents/comutil\";\r\nimport * as objectAssign from \"object-assign\";\r\nexport default class ContractForm extends React.Component<\r\n  IContractFormProps,\r\n  IRequestFormState\r\n> {\r\n  constructor(props: any) {\r\n    super(props);\r\n    this.state = {\r\n      request: undefined,\r\n      requestedItemsListFields: [\r\n        {\r\n          ariaLabel: \"申请编号\",\r\n          Name: \"requestNo\"\r\n        },\r\n        {\r\n          ariaLabel: \"合同类型\",\r\n          Name: \"ContractType\"\r\n        },\r\n        {\r\n          ariaLabel: \"合同编号\",\r\n          Name: \"ContractNo\"\r\n        },\r\n        {\r\n          ariaLabel: \"合同名称\",\r\n          Name: \"Title\"\r\n        },\r\n        {\r\n          ariaLabel: \"合同标的和数量\",\r\n          Name: \"ContractObject\"\r\n        },\r\n        {\r\n          ariaLabel: \"合同金额\",\r\n          Name: \"MoneyText\"\r\n        },\r\n        {\r\n          ariaLabel: \"付款方式\",\r\n          Name: \"PayWay\"\r\n        },\r\n        {\r\n          ariaLabel: \"备注\",\r\n          Name: \"remarks\"\r\n        },\r\n        {\r\n          ariaLabel: \"附件\",\r\n          Type: \"linkArray\",\r\n          Name: \"AttachmentFiles\"\r\n        },\r\n        {\r\n          ariaLabel: \"是否送审价中心审批\",\r\n          Name: \"NeedApproval_cn\"\r\n        }\r\n        /* {\r\n          ariaLabel: \"状态\",\r\n          Name: \"statusDesc\"\r\n        }*/\r\n      ] as IColumnField[],\r\n      requestedItems: [],\r\n      SubjectOptions: [],\r\n      TypeOptions: [],\r\n      hideDeleteDialog: true,\r\n      curUser: null,\r\n      curItem: null,\r\n      showModal: false,\r\n      defaultSubjectId: undefined\r\n    };\r\n    // injectCss();\r\n  }\r\n  public render(): React.ReactElement<IContractFormProps> {\r\n    return (\r\n      <div className={styles.contactForm}>\r\n        <div className={styles.container}>\r\n          <div className=\"ms-Grid\">\r\n            <div className=\"ms-Grid-row\">\r\n              <div className=\"ms-Grid-col ms-sm12 ms-md6 ms-lg4\">\r\n                <TextField\r\n                  label={\"申请人\"}\r\n                  value={\r\n                    this.state.request &&\r\n                    this.state.request.Author &&\r\n                    this.state.request.Author.Title\r\n                  }\r\n                  disabled={true}\r\n                />\r\n              </div>\r\n              <div className=\"ms-Grid-col ms-sm12 ms-md6 ms-lg4\">\r\n                <Dropdown\r\n                  label={\"合同主体\"}\r\n                  selectedKey={\r\n                    this.state.request\r\n                      ? this.state.request.ContractSubjectId\r\n                      : this.state.defaultSubjectId\r\n                  }\r\n                  options={this.state.SubjectOptions}\r\n                  onChanged={this.changeDropdownState}\r\n                  disabled={this._isSubjectDropDownDisabled()}\r\n                />\r\n              </div>\r\n              <div className=\"ms-Grid-col ms-sm12 ms-md6 ms-lg4\">\r\n                <div className=\"ms-Dropdown-container\">\r\n                  <label\r\n                    className=\"ms-Label ms-Dropdown-label\"\r\n                    style={{ display: \"inline-block\", padding: \"5px 0px\" }}\r\n                  >\r\n                    状态\r\n                  </label>\r\n                  <div\r\n                    aria-expanded=\"false\"\r\n                    aria-live=\"assertive\"\r\n                    aria-disabled=\"true\"\r\n                    className=\"ms-Dropdown root_44853ebf\"\r\n                  >\r\n                    <Label disabled={true}>{\"新建\"}</Label>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"ms-Grid-row\">\r\n              <div className=\"ms-Grid-col ms-sm12 ms-md6 ms-lg4\">\r\n                <TextField\r\n                  style={{ \"font-size\": \"12px\" }}\r\n                  label=\"合同相对方\"\r\n                  value={\r\n                    this.state.request ? this.state.request.RelativeParty : \"\"\r\n                  }\r\n                  placeholder=\"注：一个申请单只能填一个合同相对方\"\r\n                  disabled={this._isSubjectDropDownDisabled()}\r\n                  required={false}\r\n                  onChanged={this._RelativePartyChanged}\r\n                />\r\n              </div>\r\n              <div className=\"ms-Grid-col ms-sm12 ms-md6 ms-lg4\">\r\n                <TextField\r\n                  label=\"厂部\"\r\n                  style={{ \"font-size\": \"12px\" }}\r\n                  value={\r\n                    this.state.request ? this.state.request.FactoryDept : \"\"\r\n                  }\r\n                  disabled={this._isSubjectDropDownDisabled()}\r\n                  onChanged={this._FactoryDeptChanged}\r\n                />\r\n              </div>\r\n              <div className=\"ms-Grid-col ms-sm12 ms-md6 ms-lg4\">&nbsp;</div>\r\n            </div>\r\n            <div className={styles.toolsrow}>\r\n              <h3 className={styles.leftpanel}>已添加的合同</h3>\r\n              <div className={styles.rightpanel}>{this._getButtons()}</div>\r\n            </div>\r\n            <UxpList\r\n              data={this.state.requestedItems}\r\n              schemaFields={this.state.requestedItemsListFields}\r\n              onItemInvoked={this._openRequestForm}\r\n              onNewButtonClicked={this._NewRequestForm}\r\n              onEditButtonClicked={this._openRequestForm}\r\n              onDeleteButtonClicked={this._DeleteRequests}\r\n              selectionMode={SelectionMode.multiple}\r\n              newButtonTitle=\"新建\"\r\n              hiddenFields={[\"Id\", \"NeedApproval\"]}\r\n              label={\"\"}\r\n            />\r\n\r\n            <Modal\r\n              isOpen={this.state.showModal}\r\n              onDismiss={this._closeModal}\r\n              isBlocking={true}\r\n              containerClassName=\"ms-modalExample-container\"\r\n            >\r\n              <div className=\"ms-modalExample-header\">\r\n                <span>合同信息</span>\r\n                <i\r\n                  className=\"ms-Icon ms-Icon--BoxMultiplySolid x-hidden-focus close\"\r\n                  onClick={this._closeModal}\r\n                />\r\n              </div>\r\n              <CpsItemForm\r\n                CurContractItem={this.state.curItem}\r\n                requestedItemsListName={WebConfig.requestedItemsListName}\r\n                onDeleted={this._removeItem}\r\n                Typeoptions={this.state.TypeOptions}\r\n                onUpdated={this._updatedItem}\r\n                onAdded={this._addedItem}\r\n                onClose={this.DeleteAndClose}\r\n                subabbr={this.state.request && this.state.request.subabbr}\r\n                AddrListName={WebConfig.AddrListName}\r\n                request={this.state.request}\r\n                SubjectOptions={this.state.SubjectOptions}\r\n              />\r\n            </Modal>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  @autobind\r\n  public changeDropdownState(item: IDropdownOption): void {\r\n    var newRequest: IRequest = {} as IRequest;\r\n    objectAssign(newRequest, this.state.request);\r\n    newRequest.ContractSubject = item.text;\r\n    newRequest.ContractSubjectId = item.key as number;\r\n    const curoption: any = this.state.SubjectOptions.filter(op => {\r\n      return op.key === item.key;\r\n    })[0];\r\n    newRequest.subabbr = curoption.subabbr;\r\n    // console.log(this.state.SubjectOptions, newRequest);\r\n    this.setState({\r\n      request: newRequest\r\n    });\r\n  }\r\n\r\n  @autobind\r\n  private _updatedItem(item: IItem, doClose: boolean = true): void {\r\n    let newitems: IItem[] = [] as IItem[];\r\n\r\n    objectAssign(newitems, this.state.requestedItems);\r\n    let ItemExits: boolean = false;\r\n    newitems.some(citem => {\r\n      if (item.Id === citem.Id) {\r\n        // citem=item;\r\n        objectAssign(citem, item);\r\n        citem.MoneyText =\r\n          citem.Currency === \"N/A\"\r\n            ? citem.Currency\r\n            : `${citem.Currency}${citem.Money}`;\r\n        citem.statusDesc = statusDesc[citem.status];\r\n        ItemExits = true;\r\n        return true;\r\n      }\r\n      return false;\r\n    });\r\n    // 新建时上传附件后提交会走到这里，需添加到列表\r\n    if (!ItemExits) {\r\n      this._addedItem(item, true);\r\n      return;\r\n    }\r\n    this.setState({ requestedItems: newitems });\r\n\r\n    if (doClose) {\r\n      this.setState({ showModal: false });\r\n    }\r\n  }\r\n  @autobind\r\n  private _addedItem(item: IItem, closeModal: boolean = true): void {\r\n    let newitems: IItem[] = [] as IItem[];\r\n    objectAssign(newitems, this.state.requestedItems);\r\n    // console.log(item);\r\n    item.MoneyText =\r\n      item.Currency === \"N/A\" ? item.Currency : `${item.Currency}${item.Money}`;\r\n    item.statusDesc = statusDesc[item.status];\r\n\r\n    newitems.push(item);\r\n    this.setState({ requestedItems: newitems });\r\n\r\n    if (closeModal) {\r\n      this.setState({ showModal: false });\r\n    }\r\n  }\r\n  /*\r\n   * Requets Form Buttons related\r\n   */\r\n\r\n  @autobind\r\n  private _submit(): void {\r\n    var newRequest: IRequest = {} as IRequest;\r\n    objectAssign(newRequest, this.state.request);\r\n    // if (!this.state.request.RelativeParty||this.state.request.RelativeParty.trim() === \"\") {\r\n    // return;\r\n    // }\r\n    if (this.state.requestedItems.length === 0) {\r\n      alert(\"请添加合同内容后提交。\");\r\n      return;\r\n    }\r\n\r\n    const witems: IItem[] = this.state.requestedItems.filter(item => {\r\n      return item.status === \"0\";\r\n    });\r\n    if (witems.length === 0) {\r\n      alert(\"没有待审批的合同，不能提交。\");\r\n      return;\r\n    }\r\n    let emailbodys: any = {};\r\n    let copyItems: IItem[] = [];\r\n    objectAssign(copyItems, witems);\r\n    this._submitsubitem(witems, () => {\r\n      copyItems.map(item => {\r\n        const Key: string = item.NeedApproval\r\n          ? item.pricingcenterId + \"\"\r\n          : item.lawyerId + \"\";\r\n        if (!emailbodys[Key]) {\r\n          emailbodys[Key] = [];\r\n        }\r\n        emailbodys[Key].push({\r\n          id: item.Id,\r\n          title: item.Title,\r\n          type: item.ContractType,\r\n          requestNo: item.requestNo,\r\n          person: item.NeedApproval ? item.Pricingcenter : item.Lawyer\r\n        });\r\n      });\r\n      newRequest.state = \"审批中\";\r\n      this._updateRequest(emailbodys);\r\n    }); // 更新单个合同状态\r\n  }\r\n\r\n  private _submitsubitem(items: IItem[], callback: Function): void {\r\n    let item: IItem = items.shift();\r\n    const data: any = {\r\n      status: item.NeedApproval ? \"1\" : \"2\"\r\n    };\r\n    sp.web.lists\r\n      .getByTitle(WebConfig.requestedItemsListName)\r\n      .items.getById(item.Id)\r\n      .update(data)\r\n      .then(value => {\r\n        console.log(`合同：${item.Id}提交成功。`);\r\n        if (items.length > 0) {\r\n          this._submitsubitem(items, callback);\r\n        } else {\r\n          callback();\r\n        }\r\n      });\r\n  }\r\n\r\n  private _isSubjectDropDownDisabled(): boolean {\r\n    if (!this.state.request) {\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n  private _getButtons(): JSX.Element[] {\r\n    let buttons: JSX.Element[] = [];\r\n\r\n    if (this._isSubmitButtonHidden() === false) {\r\n      buttons.push(\r\n        <PrimaryButton\r\n          data-automation-id=\"test\"\r\n          text=\"提交\"\r\n          onClick={this._submit}\r\n        />\r\n      );\r\n    }\r\n    buttons.push(\r\n      <Button\r\n        text=\"关闭\"\r\n        onClick={() => {\r\n          document.location.href = WebConfig.CreatedByMeListPage;\r\n        }}\r\n      />\r\n    );\r\n    return buttons;\r\n  }\r\n\r\n  @autobind\r\n  private _RelativePartyChanged(value: string): void {\r\n    let data: IRequest = {} as IRequest;\r\n    objectAssign(data, this.state.request);\r\n    data.RelativeParty = value;\r\n    this.setState({ request: data });\r\n  }\r\n  @autobind\r\n  private _FactoryDeptChanged(value: string): void {\r\n    let data: IRequest = {} as IRequest;\r\n    objectAssign(data, this.state.request);\r\n    data.FactoryDept = value;\r\n    this.setState({ request: data });\r\n  }\r\n  private _isSubmitButtonHidden(): boolean {\r\n    if (!this.state.request) {\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  private _fetchRequestedItems(props: IContractFormProps): void {\r\n    if (this.state.request === undefined) {\r\n      return;\r\n    }\r\n\r\n    // get all fields that is visible and editable in a list\r\n    sp.web.lists\r\n      .getByTitle(WebConfig.requestedItemsListName)\r\n      .items.filter(`RequestIDId eq ${this.state.request.Id}`)\r\n      .get()\r\n      .then((response: IItem[]) => {\r\n        this.setState({\r\n          requestedItems: response\r\n        });\r\n      })\r\n      .catch(error => {\r\n        console.log(error);\r\n      });\r\n  }\r\n  private jumpHomePage(): void {\r\n    location.href = WebConfig.CreatedByMeListPage;\r\n    //console.log(`go to ${WebConfig.CreatedByMeListPage}...`);\r\n  }\r\n\r\n  private _updateRequest(emailbodys?: any): void {\r\n    this.setState({\r\n      hideDeleteDialog: true\r\n    });\r\n    if (emailbodys) {\r\n      contractutil.sendEmail(emailbodys, this.state.curUser);\r\n    }\r\n    console.log(\"正在删除草稿中的合同...\");\r\n    sp.web.lists\r\n      .getByTitle(WebConfig.requestedItemsListName)\r\n      .items.filter(\r\n        \"AuthorId eq \" + this.state.curUser.Id + \" and status eq '0' \"\r\n      )\r\n      .getAll()\r\n      .then(items => {\r\n        let count: number = items.length;\r\n        if (count > 0) {\r\n          count--;\r\n          items.map((item, i) => {\r\n            sp.web.lists\r\n              .getByTitle(WebConfig.requestedItemsListName)\r\n              .items.getById(item.Id)\r\n              .delete()\r\n              .then(v => {\r\n                console.log(\"已删除申请编号为:\" + item.requestNo + \"的合同\");\r\n                if (i === count) {\r\n                  this.jumpHomePage();\r\n                }\r\n              })\r\n              .catch(err => {\r\n                console.log(\"删除申请编号为:\" + item.requestNo + \"的合同失败\");\r\n                if (i === count) {\r\n                  this.jumpHomePage();\r\n                }\r\n              });\r\n          });\r\n        } else {\r\n          this.jumpHomePage();\r\n        }\r\n      });\r\n  }\r\n\r\n  public componentDidMount(): void {\r\n    sp.web.currentUser\r\n      .get()\r\n      .then(\r\n        (result => {\r\n          // console.log(result);\r\n          if (!result.Id) {\r\n            sp.web.ensureUser(result.LoginName).then(() => {\r\n              this.componentDidMount();\r\n              return;\r\n            });\r\n          }\r\n          this.setState({\r\n            curUser: result\r\n          });\r\n          if (this.props.mode === RequestFormMode.Requester) {\r\n            // this._addRequest();\r\n            var newRequest: IRequest = {} as IRequest;\r\n\r\n            newRequest.Author = result;\r\n            newRequest.state = \"新建\";\r\n            this.setState({\r\n              request: newRequest\r\n            });\r\n          }\r\n        }).bind(this)\r\n      )\r\n      .catch((error: any) => {\r\n        console.log(error);\r\n      });\r\n    this._fetchSubjectOptions(this.props);\r\n  }\r\n\r\n  /*\r\n  private _addRequest(callback?: () => void): void {\r\n    const data: any = {\r\n      ContractSubjectId: this.state.request.ContractSubjectId,\r\n      RelativeParty: this.state.request.RelativeParty,\r\n      state: this.state.request.state,\r\n      subject: this.state.request.subabbr,\r\n    };\r\n\r\n    sp.web.lists.getByTitle(WebConfig.requestsListName).items.add(data).then(((iar: ItemAddResult) => {\r\n      let curreq: IRequest = {} as IRequest;\r\n      objectAssign(curreq, this.state.request);\r\n      curreq.Id = iar.data.Id;\r\n      console.log(iar);\r\n      this.setState({\r\n        request: curreq\r\n      }, () => { if (callback) { callback(); } });\r\n    }).bind(this)).catch((error: any) => {\r\n      console.log(error);\r\n    });\r\n  }*/\r\n  public componentWillReceiveProps(nextProps): void {\r\n    this._fetchSubjectOptions(nextProps);\r\n    this._fetchRequestedItems(nextProps);\r\n  }\r\n  private _fetchSubjectOptions(props: IContractFormProps): void {\r\n    // let w: Web = this._getweb();\r\n    sp.web.lists\r\n      .getByTitle(WebConfig.subjectsListName)\r\n      .items.orderBy(\"Title\")\r\n      .getAll()\r\n      .then((response: IContractSubject[]) => {\r\n        let options: any[] = [];\r\n        let subarr: string = \"\";\r\n        var newRequest: IRequest = {} as IRequest;\r\n        objectAssign(newRequest, this.state.request);\r\n        response.map((item, i) => {\r\n          options.push({\r\n            key: item.Id,\r\n            text: item.Title,\r\n            subabbr: item.abbreviation\r\n          });\r\n          if (item.Title === \"广东溢达纺织有限公司\") {\r\n            subarr = item.abbreviation;\r\n            newRequest.ContractSubjectId = item.Id;\r\n            newRequest.subabbr = item.abbreviation;\r\n            newRequest.ContractSubject = item.Title;\r\n            this.setState({ defaultSubjectId: item.Id });\r\n          }\r\n        });\r\n\r\n        let typeoptions: any[] = [];\r\n        sp.web.lists\r\n          .getByTitle(WebConfig.contractTypeListName)\r\n          .items.select(\"*\", \"pricecenter/Title\", \"laywer/Title\")\r\n          .expand(\"pricecenter\", \"laywer\")\r\n          .orderBy(\"Title\")\r\n          .getAll()\r\n          .then((types: any[]) => {\r\n            //  console.log(types);\r\n            let Msgs: string[] = [];\r\n            types.map(typeitem => {\r\n              //  console.log(typeitem);\r\n              let isValid: boolean = true;\r\n              if (!typeitem.laywer || !typeitem.laywer.Title) {\r\n                Msgs.push(`${typeitem.Title}类别的律师`);\r\n                isValid = false;\r\n              }\r\n              if (!typeitem.pricecenter || !typeitem.pricecenter.Title) {\r\n                if (typeitem.ToPriceCenter) {\r\n                  Msgs.push(`${typeitem.Title}类别的审价人员`);\r\n                  isValid = false;\r\n                }\r\n              }\r\n              if (isValid) {\r\n                typeoptions.push({\r\n                  key: typeitem.Id,\r\n                  text: typeitem.Title,\r\n                  pricingcenterId: typeitem.pricecenterId,\r\n                  lawyerId: typeitem.laywerId,\r\n                  pricingcenter: typeitem.pricecenter\r\n                    ? typeitem.pricecenter.Title\r\n                    : \"\",\r\n                  lawyer: typeitem.laywer ? typeitem.laywer.Title : \"\",\r\n                  toprice: typeitem.ToPriceCenter\r\n                });\r\n              }\r\n            });\r\n            if (Msgs.length > 0) {\r\n              alert(\r\n                \"请配置以下信息，否则无法提交该类别合同申请：\\r\\n\" +\r\n                  Msgs.join(\"\\n\")\r\n              );\r\n            }\r\n            this.setState({\r\n              SubjectOptions: options,\r\n              request: newRequest,\r\n              TypeOptions: typeoptions\r\n            });\r\n          })\r\n          .catch(e => {\r\n            console.log(e);\r\n          });\r\n      });\r\n  }\r\n  @autobind\r\n  private _NewRequestForm(): void {\r\n    let item: IItem = {\r\n      Id: 0,\r\n      status: \"0\",\r\n      NeedApproval: true,\r\n      NeedApproval_cn: \"是\",\r\n      lawyerId: 0,\r\n      pricingcenterId: 0\r\n    } as IItem;\r\n    this.setState({ curItem: item });\r\n    this._showModal();\r\n  }\r\n  @autobind\r\n  private _DeleteRequests(items: any[]) {\r\n    console.log(items);\r\n    let newitems: IItem[] = [] as IItem[];\r\n    let Ids: number[] = [];\r\n    // objectAssign(newitems, this.state.requestedItems);\r\n    items.map(item => {\r\n      Ids.push(item.Id);\r\n      sp.web.lists\r\n        .getByTitle(WebConfig.requestedItemsListName)\r\n        .items.getById(item.Id)\r\n        .delete()\r\n        .then(v => {\r\n          console.log(\"已删除Id为：\" + item.Id + \"的记录\");\r\n        });\r\n    });\r\n    this.state.requestedItems.map(item2 => {\r\n      if (Ids.indexOf(item2.Id) < 0) {\r\n        newitems.push(item2);\r\n      }\r\n    });\r\n    this.setState({ requestedItems: newitems });\r\n  }\r\n  @autobind\r\n  private _openRequestForm(item: any, index: number): void {\r\n    let mode: string = \"\";\r\n    switch (this.props.mode) {\r\n      case RequestFormMode.Requester:\r\n        mode = \"requester\";\r\n        break;\r\n      case RequestFormMode.Admin:\r\n        mode = \"admin\";\r\n        break;\r\n      case RequestFormMode.Approver:\r\n        mode = \"approver\";\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    this.setState({ curItem: this.state.requestedItems[index] });\r\n    // console.log(this.state.requestedItems[index]);\r\n    // console.log(this.state.curItem);\r\n    this._showModal();\r\n    // window.open(`${this.props.requestFormUrl}/?request=${item.ID}&mode=${mode}`, '_self');\r\n  }\r\n  @autobind\r\n  private _showModal(): void {\r\n    this.setState({ showModal: true });\r\n  }\r\n  @autobind\r\n  private DeleteAndClose(id?: number): void {\r\n    if (id > 0) {\r\n      if (\r\n        this.state.requestedItems.filter(item => {\r\n          return item.Id === id;\r\n        }).length === 0\r\n      ) {\r\n        sp.web.lists\r\n          .getByTitle(WebConfig.requestedItemsListName)\r\n          .items.getById(id)\r\n          .delete()\r\n          .then(() => {\r\n            console.log(\"删除了记录：\" + id);\r\n          });\r\n      }\r\n    }\r\n    this.setState({ showModal: false });\r\n  }\r\n  @autobind\r\n  private _closeModal(): void {\r\n    this.setState({ showModal: false });\r\n  }\r\n  @autobind\r\n  private _removeItem(item: IItem): void {\r\n    let data: IItem[] = this.state.requestedItems.filter(it => {\r\n      return it.Id !== item.Id;\r\n    });\r\n    this.setState({ requestedItems: data });\r\n  }\r\n}\r\n"],"sourceRoot":"..\\..\\..\\..\\src"}