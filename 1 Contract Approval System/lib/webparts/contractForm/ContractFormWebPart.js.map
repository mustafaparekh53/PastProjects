{"version":3,"sources":["../../src/webparts/contractForm/ContractFormWebPart.ts"],"names":[],"mappings":"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","file":"webparts/contractForm/ContractFormWebPart.js","sourcesContent":["import * as React from \"react\";\r\nimport * as ReactDom from \"react-dom\";\r\nimport { Version } from \"@microsoft/sp-core-library\";\r\nimport {\r\n  BaseClientSideWebPart,\r\n  IPropertyPaneConfiguration,\r\n  PropertyPaneTextField\r\n} from \"@microsoft/sp-webpart-base\";\r\n\r\nimport * as strings from \"ContractFormWebPartStrings\";\r\nimport ContractForm from \"./components/ContractForm\";\r\nimport {\r\n  IContractFormProps,\r\n  RequestFormMode\r\n} from \"./components/IContractFormProps\";\r\nimport { sp } from \"@pnp/sp\";\r\nimport \"@pnp/polyfill-ie11\";\r\nimport CpsItemForm from \"./components/ContractItemEditForm/CpsItemForm\";\r\n\r\nexport interface IContractFormWebPartProps {\r\n  homepageUrl: string;\r\n}\r\n\r\nexport default class ContractFormWebPart extends BaseClientSideWebPart<\r\n  IContractFormWebPartProps\r\n> {\r\n  public onInit(): Promise<void> {\r\n    return super.onInit().then(_ => {\r\n      // other init code may be present\r\n      sp.setup({\r\n        spfxContext: this.context\r\n      });\r\n    });\r\n  }\r\n  public render(): void {\r\n    const url: URL = new URL(document.URL);\r\n    let mode: RequestFormMode;\r\n    switch (url.searchParams.get(\"mode\")) {\r\n      case \"requester\":\r\n        mode = RequestFormMode.Requester;\r\n        break;\r\n      case \"approver\":\r\n        mode = RequestFormMode.Approver;\r\n        break;\r\n      case \"admin\":\r\n        mode = RequestFormMode.Admin;\r\n        break;\r\n      default:\r\n        mode = RequestFormMode.Requester;\r\n        break;\r\n    }\r\n    const idstr: string = url.searchParams.get(\"request\");\r\n    let id: number = parseInt(idstr, 10);\r\n    id = isNaN(id) ? 0 : id;\r\n    // console.log(\"Id=\"+id);\r\n    const element: React.ReactElement<IContractFormProps> =\r\n      id > 0\r\n        ? React.createElement(CpsItemForm, {\r\n            id: url.searchParams.get(\"request\"),\r\n            mode: mode\r\n          })\r\n        : React.createElement(ContractForm, {\r\n            spHttpClient: this.context.spHttpClient,\r\n            siteUrl: this.context.pageContext.web.absoluteUrl,\r\n            id: url.searchParams.get(\"request\"),\r\n            mode: mode\r\n          });\r\n\r\n    ReactDom.render(element, this.domElement);\r\n  }\r\n\r\n  protected get dataVersion(): Version {\r\n    return Version.parse(\"1.0\");\r\n  }\r\n\r\n  protected getPropertyPaneConfiguration(): IPropertyPaneConfiguration {\r\n    return {\r\n      pages: [\r\n        {\r\n          header: {\r\n            description: strings.PropertyPaneDescription\r\n          },\r\n          groups: [\r\n            {\r\n              groupName: strings.BasicGroupName,\r\n              groupFields: [\r\n                PropertyPaneTextField(\"description\", {\r\n                  label: strings.DescriptionFieldLabel\r\n                })\r\n              ]\r\n            }\r\n          ]\r\n        }\r\n      ]\r\n    };\r\n  }\r\n}\r\n"],"sourceRoot":"..\\..\\..\\src"}