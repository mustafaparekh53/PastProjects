{"version":3,"sources":["../../src/webparts/allContracts/components/AllContracts.tsx"],"names":[],"mappings":"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","file":"webparts/allContracts/components/AllContracts.js","sourcesContent":["import * as React from \"react\";\r\nimport styles from \"./AllContracts.module.scss\";\r\nimport { IAllContractsProps } from \"./IAllContractsProps\";\r\n\r\nimport UxpList from \"../../ComComponents/UxpList/UxpList\";\r\nimport { IColumnField } from \"../../ComComponents/interfaces/IColumnField\";\r\nimport { WebConfig } from \"../../ComComponents/webconfig\";\r\nimport { sp, Items, Web, PagedItemCollection } from \"@pnp/sp\";\r\nimport \"@pnp/polyfill-ie11\";\r\nimport Pagination from \"office-ui-fabric-react-pagination\";\r\nimport { statusDesc } from \"../../ComComponents/interfaces/IItem\";\r\nimport * as moment from \"moment\";\r\nimport \"moment/locale/zh-cn\";\r\nimport { ODataDefaultParser } from \"@pnp/odata\";\r\nimport * as XLSX from \"xlsx\";\r\nimport { GetFileRandName, FieldNames } from \"../../ComComponents/comutil\";\r\nimport { Button } from \"office-ui-fabric-react/lib/Button\";\r\nimport {\r\n  IDatePickerStrings,\r\n  DatePicker,\r\n  DayOfWeek\r\n} from \"office-ui-fabric-react/lib/DatePicker\";\r\nimport {\r\n  ColumnActionsMode,\r\n  SelectionMode,\r\n  IColumn\r\n} from \"office-ui-fabric-react/lib/DetailsList\";\r\nimport { Link } from \"office-ui-fabric-react/lib/Link\";\r\nimport { autobind } from \"office-ui-fabric-react/lib/Utilities\";\r\nimport { IAllContractsState } from \"./IAllContractsState\";\r\nimport {\r\n  OfficeUiFabricPeoplePickerContainer,\r\n  IOfficeUiFabricPeoplePickerSelection\r\n} from \"../../../components/officeUiFabricPeoplePicker\";\r\nconst DayPickerStrings: IDatePickerStrings = {\r\n  months: [\r\n    \"一月\",\r\n    \"二月\",\r\n    \"三月\",\r\n    \"四月\",\r\n    \"五月\",\r\n    \"六月\",\r\n    \"七月\",\r\n    \"八月\",\r\n    \"九月\",\r\n    \"十月\",\r\n    \"十一月\",\r\n    \"十二月\"\r\n  ],\r\n  shortMonths: [\r\n    \"一\",\r\n    \"二\",\r\n    \"三\",\r\n    \"四\",\r\n    \"五\",\r\n    \"六\",\r\n    \"七\",\r\n    \"八\",\r\n    \"九\",\r\n    \"十\",\r\n    \"十一\",\r\n    \"十二\"\r\n  ],\r\n  days: [\"周日\", \"周一\", \"周二\", \"周三\", \"周四\", \"周五\", \"周六\"],\r\n  shortDays: [\"日\", \"一\", \"二\", \"三\", \"四\", \"五\", \"六\"],\r\n  goToToday: \"今天\",\r\n  prevMonthAriaLabel: \"上月\",\r\n  nextMonthAriaLabel: \"下月\",\r\n  prevYearAriaLabel: \"上一年\",\r\n  nextYearAriaLabel: \"下一年\"\r\n};\r\n\r\nconst requestedItemsListFields: any[] = [\r\n  {\r\n    ariaLabel: \"合同审批单号\",\r\n    Name: \"requestNo\",\r\n    columnActionsMode: ColumnActionsMode.clickable,\r\n    maxWidth: 75\r\n  },\r\n  {\r\n    ariaLabel: \"当前状态\",\r\n    Name: \"state\",\r\n    maxWidth: 100\r\n  },\r\n  {\r\n    ariaLabel: \"是否审价中心审批\",\r\n    Name: \"NeedApproval\",\r\n    maxWidth: 100\r\n  },\r\n  {\r\n    ariaLabel: \"合同主体\",\r\n    Name: \"mainbody\",\r\n    minWidth: 250\r\n  },\r\n  {\r\n    ariaLabel: \"合同相对方\",\r\n    Name: \"RelativeParty\",\r\n    minWidth: 250\r\n  },\r\n  {\r\n    ariaLabel: \"合同类型\",\r\n    Name: \"ContractType\",\r\n    minWidth: 250\r\n  },\r\n  {\r\n    ariaLabel: \"合同编号\",\r\n    Name: \"ContractNo\",\r\n    minWidth: 250\r\n  },\r\n  {\r\n    ariaLabel: \"合同名称\",\r\n    Name: \"Title\",\r\n    minWidth: 250\r\n  },\r\n  {\r\n    ariaLabel: \"合同标的和数量\",\r\n    Name: \"ContractObject\"\r\n  },\r\n  {\r\n    ariaLabel: \"合同金额\",\r\n    Name: \"MoneyText\"\r\n  },\r\n  {\r\n    ariaLabel: \"货币单位\",\r\n    Name: \"Currency\"\r\n  },\r\n  {\r\n    ariaLabel: \"付款方式\",\r\n    Name: \"PayWay\"\r\n  },\r\n  {\r\n    ariaLabel: \"备注\",\r\n    Name: \"remarks\"\r\n  },\r\n  {\r\n    ariaLabel: \"申请人\",\r\n    Name: \"Author\"\r\n  },\r\n  {\r\n    ariaLabel: \"创建时间\",\r\n    Name: \"Created\"\r\n  },\r\n  {\r\n    ariaLabel: \"签订日期\",\r\n    Name: \"signingDate\"\r\n  },\r\n  {\r\n    ariaLabel: \"签署代表\",\r\n    Name: \"representative\"\r\n  },\r\n  {\r\n    ariaLabel: \"附件\",\r\n    Type: \"linkArray\",\r\n    Name: \"AttachmentFiles\"\r\n  }\r\n];\r\n\r\nexport default class AllContracts extends React.Component<\r\n  IAllContractsProps,\r\n  IAllContractsState\r\n> {\r\n  private ContractTypes: any;\r\n  private ContractStatus: HTMLSelectElement;\r\n  private ContractMainBodies: HTMLSelectElement;\r\n  private ContractTitle: HTMLInputElement;\r\n  private ContractNo: HTMLInputElement;\r\n  private ContractCurrencies: HTMLSelectElement;\r\n  private MinMoneyInput: HTMLInputElement;\r\n  private MaxMoneyInput: HTMLInputElement;\r\n  private RelativePartyinput: HTMLInputElement;\r\n  private ContractDepts: HTMLSelectElement;\r\n  public constructor(props: any) {\r\n    super(props);\r\n    this.state = {\r\n      curUser: {},\r\n      requestedItems: [],\r\n      contractTypes: [],\r\n      ContractType: \"\",\r\n      ContractStatu: \"\",\r\n      ContractMainBodies: [],\r\n      ContractMainBody: \"\",\r\n      StatffDepts: [],\r\n      curDeptId: \"\",\r\n      ContractTitle: \"\",\r\n      ContractNo: \"\",\r\n      filterCountstr: \"\",\r\n      filterstr: \"\",\r\n      ContractCurrency: \"\",\r\n      minMoney: \"\",\r\n      maxMoney: \"\",\r\n      ContractMaxDate: new Date(),\r\n      ContractMinDate: new Date(),\r\n      RelativeParty: \"\",\r\n      current: 1,\r\n      total: 1, //总页数\r\n      pageSize: 10,\r\n      fieldNames: 0,\r\n      Author: []\r\n    };\r\n  }\r\n  public render(): React.ReactElement<IAllContractsProps> {\r\n    return (\r\n      <div className={styles.allContracts}>\r\n        <div className={styles.container}>\r\n          <fieldset>\r\n            <legend>\r\n              <h3>查询条件</h3>\r\n            </legend>\r\n            <div className=\"ms-Grid\" dir=\"ltr\">\r\n              <div className=\"ms-Grid-row\">\r\n                <div\r\n                  className=\"ms-Grid-col ms-sm6 ms-md4 ms-lg1\"\r\n                  style={{ paddingLeft: \"10px\", minWidth: \"80px\" }}\r\n                >\r\n                  合同类型\r\n                </div>\r\n                <div className=\"ms-Grid-col ms-sm6 ms-md4 ms-lg3\">\r\n                  <select\r\n                    ref={c => (this.ContractTypes = c)}\r\n                    value={this.state.ContractType}\r\n                    onChange={this.onContractTypeChanged}\r\n                  >\r\n                    <option value=\"\">不限</option>\r\n                    {this.state.contractTypes.map(typeitem => {\r\n                      return (\r\n                        <option value={typeitem.Id}>{typeitem.Title}</option>\r\n                      );\r\n                    })}\r\n                  </select>\r\n                </div>\r\n                <div className=\"ms-Grid-col ms-sm6 ms-md4 ms-lg1\">合同主体</div>\r\n                <div className=\"ms-Grid-col ms-sm6 ms-md4 ms-lg3\">\r\n                  <select\r\n                    ref={c => (this.ContractMainBodies = c)}\r\n                    value={this.state.ContractMainBody}\r\n                    onChange={this.onContractMainBodyChanged}\r\n                    style={{ maxWidth: \"97%\" }}\r\n                  >\r\n                    <option value=\"\">不限</option>\r\n                    {this.state.ContractMainBodies.map(item => {\r\n                      return <option value={item.Title}>{item.Title}</option>;\r\n                    })}\r\n                  </select>\r\n                </div>\r\n                <div className=\"ms-Grid-col ms-sm6 ms-md4 ms-lg1\">当前状态</div>\r\n                <div className=\"ms-Grid-col ms-sm6 ms-md4 ms-lg1\">\r\n                  <select\r\n                    ref={c => (this.ContractStatus = c)}\r\n                    value={this.state.ContractStatu}\r\n                    onChange={this.onContractStatuChanged}\r\n                  >\r\n                    <option value=\"\">不限</option>\r\n                    <option value=\"3\">合同已审</option>\r\n                    <option value=\"2\">律师审批</option>\r\n                    <option value=\"1\">审价中心</option>\r\n                    <option value=\"-1,-2\">已驳回</option>\r\n                    <option value=\"-4\">已取消</option>\r\n                  </select>\r\n                </div>\r\n              </div>\r\n              <div className=\"ms-Grid-row\">\r\n                <div\r\n                  className=\"ms-Grid-col ms-sm6 ms-md4 ms-lg1\"\r\n                  style={{ paddingLeft: \"10px\", minWidth: \"80px\" }}\r\n                >\r\n                  合同名称\r\n                </div>\r\n                <div className=\"ms-Grid-col ms-sm6 ms-md4 ms-lg3\">\r\n                  <input\r\n                    type=\"text\"\r\n                    value={\r\n                      this.state.ContractTitle ? this.state.ContractTitle : \"\"\r\n                    }\r\n                    ref={c => (this.ContractTitle = c)}\r\n                    onChange={this.onContractTitleChanged}\r\n                  />\r\n                </div>\r\n                <div className=\"ms-Grid-col ms-sm6 ms-md4 ms-lg1\">合同编号</div>\r\n                <div className=\"ms-Grid-col ms-sm6 ms-md4 ms-lg3\">\r\n                  <input\r\n                    type=\"text\"\r\n                    ref={c => (this.ContractNo = c)}\r\n                    value={this.state.ContractNo ? this.state.ContractNo : \"\"}\r\n                    onChange={this.onContractNoChanged}\r\n                  />\r\n                </div>\r\n                <div className=\"ms-Grid-col ms-sm6 ms-md4 ms-lg1\">货币单位</div>\r\n                <div className=\"ms-Grid-col ms-sm6 ms-md4 ms-lg2\">\r\n                  <select\r\n                    ref={c => (this.ContractCurrencies = c)}\r\n                    value={this.state.ContractCurrency}\r\n                    onChange={this.onContractCurrencyChanged}\r\n                  >\r\n                    <option value=\"\">不限</option>\r\n                    <option value=\"RMB\">RMB</option>\r\n                    <option value=\"USD\">USD</option>\r\n                    <option value=\"EUR\">EUR</option>\r\n                    <option value=\"N/A\">N/A</option>\r\n                  </select>\r\n                </div>\r\n              </div>\r\n              <div className=\"ms-Grid-row\">\r\n                <div\r\n                  className=\"ms-Grid-col ms-sm6 ms-md3 ms-lg1\"\r\n                  style={{ paddingLeft: \"10px\", minWidth: \"80px\" }}\r\n                >\r\n                  合同相对方\r\n                </div>\r\n                <div className=\"ms-Grid-col ms-sm6 ms-md3 ms-lg3\">\r\n                  <input\r\n                    type=\"text\"\r\n                    ref={c => (this.RelativePartyinput = c)}\r\n                    value={\r\n                      this.state.RelativeParty ? this.state.RelativeParty : \"\"\r\n                    }\r\n                    onChange={this.onRelativePartyChanged}\r\n                  />\r\n                </div>\r\n                <div className=\"ms-Grid-col ms-sm6 ms-md4 ms-lg1\">金额</div>\r\n                <div\r\n                  className=\"ms-Grid-col ms-sm6 ms-md4 ms-lg1\"\r\n                  style={{ width: \"74px\" }}\r\n                >\r\n                  <input\r\n                    ref={c => (this.MinMoneyInput = c)}\r\n                    type=\"number\"\r\n                    value={this.state.minMoney ? this.state.minMoney : \"\"}\r\n                    onChange={this.setMinMoney}\r\n                    placeholder=\"最小值\"\r\n                    style={{ maxWidth: \"65px\", height: \"26px\" }}\r\n                  />\r\n                </div>\r\n                <div\r\n                  className=\"ms-Grid-col ms-sm6 ms-md4 ms-lg1\"\r\n                  style={{ textAlign: \"center\", maxWidth: \"10px\" }}\r\n                >\r\n                  -\r\n                </div>\r\n                <div className=\"ms-Grid-col ms-sm6 ms-md4 ms-lg1\">\r\n                  <input\r\n                    ref={c => (this.MaxMoneyInput = c)}\r\n                    type=\"number\"\r\n                    value={this.state.maxMoney ? this.state.maxMoney : \"\"}\r\n                    onChange={this.setMaxMoney}\r\n                    placeholder=\"最大值\"\r\n                    style={{ maxWidth: \"65px\", height: \"26px\" }}\r\n                  />\r\n                </div>\r\n                <div className=\"ms-Grid-col ms-sm6 ms-md4 ms-lg1\">所属部门</div>\r\n                <div className=\"ms-Grid-col ms-sm6 ms-md4 ms-lg1\">\r\n                  <select\r\n                    ref={c => (this.ContractDepts = c)}\r\n                    value={this.state.curDeptId}\r\n                    onChange={this.onContractDeptChanged}\r\n                    style={{ maxWidth: \"97%\" }}\r\n                  >\r\n                    <option value=\"\">不限</option>\r\n                    {this.state.StatffDepts.map(item => {\r\n                      return <option value={item.Id}>{item.Title}</option>;\r\n                    })}\r\n                  </select>\r\n                </div>\r\n              </div>\r\n              <div className=\"ms-Grid-row\">\r\n                <div\r\n                  className=\"ms-Grid-col ms-sm6 ms-md4 ms-lg1\"\r\n                  style={{ paddingLeft: \"10px\", minWidth: \"80px\" }}\r\n                >\r\n                  创建时间\r\n                </div>\r\n                <div className=\"ms-Grid-col ms-sm6 ms-md6 ms-lg2\">\r\n                  <DatePicker\r\n                    firstDayOfWeek={DayOfWeek.Sunday}\r\n                    strings={DayPickerStrings}\r\n                    placeholder=\"最小值\"\r\n                    label=\"\"\r\n                    isRequired={false}\r\n                    allowTextInput={true}\r\n                    formatDate={this._formatDate}\r\n                    // tslint:disable:jsx-no-lambda\r\n                    onAfterMenuDismiss={() =>\r\n                      console.log(\"onAfterMenuDismiss called\")\r\n                    }\r\n                    onSelectDate={this._setMinDate}\r\n                    value={\r\n                      this.state.ContractMinDate\r\n                        ? moment(\r\n                            this.state.ContractMinDate,\r\n                            moment.ISO_8601\r\n                          ).toDate()\r\n                        : null\r\n                    }\r\n                  />\r\n                </div>\r\n                <div\r\n                  className=\"ms-Grid-col ms-sm6 ms-md4 ms-lg1\"\r\n                  style={{ textAlign: \"center\", maxWidth: \"20px\" }}\r\n                >\r\n                  -\r\n                </div>\r\n                <div className=\"ms-Grid-col ms-sm6 ms-md6 ms-lg2\">\r\n                  <DatePicker\r\n                    firstDayOfWeek={DayOfWeek.Sunday}\r\n                    strings={DayPickerStrings}\r\n                    placeholder=\"最大值\"\r\n                    isRequired={false}\r\n                    allowTextInput={true}\r\n                    formatDate={this._formatDate}\r\n                    // tslint:disable:jsx-no-lambda\r\n                    onAfterMenuDismiss={() =>\r\n                      console.log(\"onAfterMenuDismiss called\")\r\n                    }\r\n                    onSelectDate={this._setMaxDate}\r\n                    value={\r\n                      this.state.ContractMaxDate\r\n                        ? moment(\r\n                            this.state.ContractMaxDate,\r\n                            moment.ISO_8601\r\n                          ).toDate()\r\n                        : null\r\n                    }\r\n                  />\r\n                </div>\r\n                <div\r\n                  className=\"ms-Grid-col ms-sm6 ms-md4 ms-lg1\"\r\n                  style={{ marginTop: \"0px\", textAlign: \"center\" }}\r\n                >\r\n                  申请人\r\n                </div>\r\n                <div className=\"ms-Grid-col ms-sm6 ms-md4 ms-lg5\">\r\n                  <OfficeUiFabricPeoplePickerContainer\r\n                    principalTypeUser={true}\r\n                    principalTypeSharePointGroup={false}\r\n                    principalTypeSecurityGroup={false}\r\n                    principalTypeDistributionList={false}\r\n                    itemLimit={1}\r\n                    maximumEntitySuggestions={5}\r\n                    onChange={this.onAuthorChanged}\r\n                    selections={this.state.Author ? this.state.Author : []}\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"ms-Grid-row\">\r\n                <div\r\n                  className=\"ms-Grid-col ms-sm12 ms-md12 ms-lg12\"\r\n                  style={{\r\n                    textAlign: \"right\",\r\n                    marginTop: \"10px\",\r\n                    paddingRight: \"40px\"\r\n                  }}\r\n                >\r\n                  <Button\r\n                    onClick={() => {\r\n                      this.Search();\r\n                    }}\r\n                  >\r\n                    查询\r\n                  </Button>\r\n                  &nbsp;\r\n                  <Button\r\n                    onClick={() => {\r\n                      this.setState(\r\n                        {\r\n                          ContractType: \"\",\r\n                          ContractStatu: \"\",\r\n                          ContractMainBody: \"\",\r\n                          ContractTitle: \"\",\r\n                          ContractNo: \"\",\r\n                          ContractCurrency: \"\",\r\n                          filterCountstr: \"\",\r\n                          filterstr: \"\",\r\n                          minMoney: \"\",\r\n                          maxMoney: \"\",\r\n                          RelativeParty: \"\",\r\n                          ContractMaxDate: new Date(),\r\n                          ContractMinDate: new Date(),\r\n                          curDeptId: \"\",\r\n                          Author: []\r\n                        },\r\n                        () => {\r\n                          this.Search();\r\n                        }\r\n                      );\r\n                    }}\r\n                  >\r\n                    重置\r\n                  </Button>\r\n                  &nbsp;\r\n                  <Button\r\n                    onClick={() => {\r\n                      this.exportDatas();\r\n                    }}\r\n                  >\r\n                    导出\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </fieldset>\r\n\r\n          <UxpList\r\n            data={this.state.requestedItems}\r\n            schemaFields={requestedItemsListFields}\r\n            selectionMode={SelectionMode.none}\r\n            onRenderItemColumn={this._onRenderItemColumn}\r\n            onItemInvoked={this._ItemInvoked}\r\n            label={\"\"}\r\n            ishiddenNewButton={true}\r\n            hiddenFields={[\r\n              \"lawyerId\",\r\n              \"AuthorId\",\r\n              \"status\",\r\n              \"Id\",\r\n              \"AuthorTitle\"\r\n            ]}\r\n          />\r\n          <Pagination\r\n            currentPage={this.state.current}\r\n            totalPages={this.state.total}\r\n            onChange={this._getpageditems}\r\n          />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n  private _onRenderItemColumn(\r\n    item: any,\r\n    index: number,\r\n    column: IColumn\r\n  ): JSX.Element {\r\n    // console.log(item,index,column);\r\n    if (column.columnActionsMode === ColumnActionsMode.clickable) {\r\n      return (\r\n        <Link\r\n          data-selection-invoke={true}\r\n          href={`${WebConfig.NewContractPage}?request=${item.Id}`}\r\n        >\r\n          {item[column.fieldName]}\r\n        </Link>\r\n      );\r\n    }\r\n\r\n    return item[column.fieldName];\r\n  }\r\n  private _ItemInvoked(item?: any, index?: number, ev?: Event): void {\r\n    const Id: number = this.state.requestedItems[index].Id;\r\n    window.location.href = `${WebConfig.NewContractPage}?request=${Id}`;\r\n  }\r\n  public componentDidMount(): void {\r\n    sp.web.currentUser.get().then(result => {\r\n      // console.log(result);\r\n\r\n      const odd: ODataDefaultParser = new ODataDefaultParser();\r\n      let tweb: Web = new Web(\"/\", `_vti_bin/listdata.svc/`);\r\n      const header: HeadersInit = {\r\n        Accept: \"application/json;odata=verbose,text/plain\"\r\n      };\r\n      tweb.get(odd, header).then(o => {\r\n        //console.log((o.EntitySets as any[]).lastIndexOf(\"网站页面\"));\r\n        let language: number =\r\n          (o.EntitySets as any[]).lastIndexOf(\"网站页面\") > 0 ? 1 : 0;\r\n        this.setState({ curUser: result, fieldNames: language }, () => {\r\n          sp.web.lists\r\n            .getByTitle(WebConfig.contractTypeListName)\r\n            .items.getAll()\r\n            .then(items => {\r\n              let cttypes: any[] = [];\r\n              let ctmainbodys: any[] = [];\r\n              let ctstaffdepts: any[] = [];\r\n              items.map(item => {\r\n                cttypes.push({ Id: item.Id, Title: item.Title });\r\n              });\r\n              sp.web.lists\r\n                .getByTitle(WebConfig.subjectsListName)\r\n                .items.getAll()\r\n                .then(sbjs => {\r\n                  sbjs.map(sbj => {\r\n                    ctmainbodys.push({ Title: sbj.Title });\r\n                  });\r\n\r\n                  sp.web.lists\r\n                    .getByTitle(WebConfig.DeptsListName)\r\n                    .items.getAll()\r\n                    .then(depts => {\r\n                      depts.map(dpt => {\r\n                        ctstaffdepts.push({ Id: dpt.Id, Title: dpt.Title });\r\n                      });\r\n                      this.setState({\r\n                        contractTypes: cttypes,\r\n                        ContractMainBodies: ctmainbodys,\r\n                        StatffDepts: ctstaffdepts\r\n                      });\r\n                    });\r\n                });\r\n            });\r\n          this.Search();\r\n          // } else {\r\n          //  alert(\"您没有操作权限\");\r\n          //  document.location.href = WebConfig.CreatedByMeListPage;\r\n          // }\r\n        });\r\n      });\r\n    });\r\n  }\r\n  private colNames: string[] = [\r\n    \"合同审批单号\",\r\n    \"合同主体\",\r\n    \"合同相对方\",\r\n    \"合同编号\",\r\n    \"合同名称\",\r\n    \"合同类别\",\r\n    \"合同标的和数量\",\r\n    \"合同金额\",\r\n    \"货币单位\",\r\n    \"付款方式\",\r\n    \"当前状态\",\r\n    \"是否审价中心审批\",\r\n    \"备注\",\r\n    \"厂部\",\r\n    \"签订日期\",\r\n    \"签署代表\",\r\n    \"申请人\",\r\n    \"创建时间\",\r\n    \"审价人\",\r\n    \"审批律师\",\r\n    \"附件\"\r\n  ];\r\n  private colKeys: string[] = [\r\n    \"requestNo\",\r\n    \"mainbody\",\r\n    \"RelativeParty\",\r\n    \"ContractNo\",\r\n    \"Title\",\r\n    \"ContractType/Title\",\r\n    \"ContractObject\",\r\n    \"Money\",\r\n    \"Currency\",\r\n    \"PayWay\",\r\n    \"state\",\r\n    \"NeedApproval\",\r\n    \"remarks\",\r\n    \"FactoryDept\",\r\n    \"signingDate\",\r\n    \"representative/Title\",\r\n    \"Author/Title\",\r\n    \"Created\",\r\n    \"pricingcenter/Title\",\r\n    \"lawyer/Title\",\r\n    \"AttachmentFiles\"\r\n  ];\r\n  @autobind\r\n  public getDatas(): void {\r\n    const odd: ODataDefaultParser = new ODataDefaultParser();\r\n    let tweb: Web = new Web(\r\n      \"/\",\r\n      `_vti_bin/listdata.svc/${\r\n        WebConfig.requestedItemsListName\r\n      }/$count?$filter=${this.state.filterCountstr}`\r\n    );\r\n    const header: HeadersInit = {\r\n      Accept: \"application/json;odata=verbose,text/plain\"\r\n    };\r\n    tweb.get(odd, { headers: header }).then(result => {\r\n      // console.log(result);\r\n      let ret: number = parseInt(result, 10);\r\n      this.setState({\r\n        total:\r\n          isNaN(ret) || ret === 0\r\n            ? 1\r\n            : Math.floor((ret + this.state.pageSize - 1) / this.state.pageSize)\r\n      });\r\n      this.setState({ current: 1 }, () => {\r\n        this._getpageditems(1);\r\n      });\r\n    });\r\n  }\r\n  private _formatDate(datevale: Date): string {\r\n    return datevale.toLocaleDateString();\r\n  }\r\n  public getFilterStr(CallBack: Function): void {\r\n    let filterCountstr: string = \"Status ne '0'\";\r\n    let filterStr: string = \"status ne '0'\";\r\n    if (this.state.ContractType && this.state.ContractType.trim() !== \"\") {\r\n      filterStr += \" and ContractTypeId eq \" + this.state.ContractType;\r\n      filterCountstr += \" and ContractTypeId eq \" + this.state.ContractType;\r\n    }\r\n    if (this.state.ContractStatu && this.state.ContractStatu.trim() !== \"\") {\r\n      filterCountstr += \" and \";\r\n      filterStr += \" and \";\r\n      let statuss: string[] = this.state.ContractStatu.split(\",\");\r\n      if (statuss.length > 1) {\r\n        let allStatus: string = statuss\r\n          .map(stu => {\r\n            return \"Status eq '\" + stu + \"'\";\r\n          })\r\n          .join(\" or \");\r\n        filterCountstr += \"(\" + allStatus + \") \";\r\n        filterStr += \"(\" + allStatus.toLowerCase() + \") \";\r\n      } else {\r\n        filterCountstr += \" Status eq '\" + this.state.ContractStatu + \"' \";\r\n        filterStr += \" status eq '\" + this.state.ContractStatu + \"' \";\r\n      }\r\n    }\r\n    if (\r\n      this.state.ContractMainBody &&\r\n      this.state.ContractMainBody.trim() !== \"\"\r\n    ) {\r\n      let mbody: string = this.state.ContractMainBody.trim();\r\n      filterCountstr += \" and Mainbody eq '\" + mbody + \"' \";\r\n      filterStr += \" and  mainbody eq '\" + mbody + \"' \";\r\n    }\r\n    if (this.state.curDeptId && this.state.curDeptId.trim() !== \"\") {\r\n      filterCountstr += \" and StaffDeptId eq \" + this.state.curDeptId + \" \";\r\n      filterStr += \" and  StaffDeptId eq \" + this.state.curDeptId + \" \";\r\n    }\r\n    if (this.state.RelativeParty && this.state.RelativeParty.trim() !== \"\") {\r\n      let mbody: string = encodeURIComponent(this.state.RelativeParty.trim());\r\n      filterCountstr += \" and RelativeParty eq '\" + mbody + \"' \";\r\n      filterStr += \" and RelativeParty eq '\" + mbody + \"' \";\r\n    }\r\n    if (this.state.ContractTitle && this.state.ContractTitle.trim() !== \"\") {\r\n      let title: string = encodeURIComponent(this.state.ContractTitle.trim());\r\n      filterCountstr += \" and substringof('\" + title + \"',Title) \";\r\n      filterStr += \" and substringof('\" + title + \"',Title) \";\r\n    }\r\n    if (this.state.ContractNo && this.state.ContractNo.trim() !== \"\") {\r\n      let title: string = this.state.ContractNo.trim();\r\n      filterCountstr += \" and substringof('\" + title + \"',ContractNo) \";\r\n      filterStr += \" and substringof('\" + title + \"',ContractNo) \";\r\n    }\r\n    if (\r\n      this.state.ContractCurrency &&\r\n      this.state.ContractCurrency.trim() !== \"\"\r\n    ) {\r\n      filterCountstr +=\r\n        \" and CurrencyValue eq '\" + this.state.ContractCurrency + \"' \";\r\n      filterStr += \" and Currency eq '\" + this.state.ContractCurrency + \"' \";\r\n    }\r\n    if (this.state.minMoney) {\r\n      filterCountstr += \" and Money ge \" + this.state.minMoney;\r\n      filterStr += \" and Money ge \" + this.state.minMoney;\r\n    }\r\n    if (this.state.maxMoney) {\r\n      filterCountstr += \" and Money le \" + this.state.maxMoney;\r\n      filterStr += \" and Money le \" + this.state.maxMoney;\r\n    }\r\n    if (this.state.ContractMinDate) {\r\n      filterCountstr +=\r\n        \" and \" +\r\n        FieldNames[this.state.fieldNames].Created +\r\n        \" ge datetime'\" +\r\n        this.state.ContractMinDate.toISOString() +\r\n        \"'\";\r\n      filterStr +=\r\n        \" and Created ge datetime'\" +\r\n        this.state.ContractMinDate.toISOString() +\r\n        \"'\";\r\n    }\r\n    if (this.state.ContractMaxDate) {\r\n      let maxDay: Date = new Date(this.state.ContractMaxDate.getTime());\r\n      maxDay.setDate(maxDay.getDate() + 1);\r\n      filterCountstr +=\r\n        \" and \" +\r\n        FieldNames[this.state.fieldNames].Created +\r\n        \" lt datetime'\" +\r\n        maxDay.toISOString() +\r\n        \"'\";\r\n      filterStr += \" and  Created lt datetime'\" + maxDay.toISOString() + \"'\";\r\n    }\r\n    if (this.state.Author && this.state.Author.length > 0) {\r\n      filterCountstr +=\r\n        \" and \" +\r\n        FieldNames[this.state.fieldNames].AuthorId +\r\n        \" eq \" +\r\n        this.state.Author[0].id;\r\n      filterStr += \" and AuthorId eq \" + this.state.Author[0].id;\r\n      console.log(filterCountstr);\r\n    }\r\n    this.setState(\r\n      { current: 1, filterCountstr: filterCountstr, filterstr: filterStr },\r\n      () => {\r\n        CallBack();\r\n      }\r\n    );\r\n  }\r\n  @autobind\r\n  public Search(): void {\r\n    this.getFilterStr(this.getDatas);\r\n  }\r\n  @autobind\r\n  public exportDatas(): void {\r\n    this.getFilterStr(this._exportDatas);\r\n  }\r\n  @autobind\r\n  public _exportDatas(): void {\r\n    let expItems: any[] = [];\r\n    let attfinfos: any[] = [];\r\n    expItems.push(this.colNames);\r\n    sp.web.lists\r\n      .getByTitle(WebConfig.requestedItemsListName)\r\n      .items.filter(`${this.state.filterstr}`)\r\n      .select(\r\n        \"*\",\r\n        \"AttachmentFiles\",\r\n        \"ContractType/Title\",\r\n        \"representative/Title\",\r\n        \"Author/Title\",\r\n        \"pricingcenter/Title\",\r\n        \"lawyer/Title\"\r\n      )\r\n      .expand(\r\n        \"AttachmentFiles\",\r\n        \"ContractType\",\r\n        \"representative/Id\",\r\n        \"Author\",\r\n        \"pricingcenter\",\r\n        \"lawyer\"\r\n      )\r\n      .orderBy(\"Id\", false)\r\n      .top(2000)\r\n      .getPaged()\r\n      .then(items => {\r\n        this.fillDatas(items, expItems, attfinfos);\r\n        this._pagedItemsToExcel(items, expItems, attfinfos);\r\n      });\r\n  }\r\n  @autobind\r\n  private onContractTypeChanged(e: any): void {\r\n    // console.log(this.ContractTypes.value);\r\n    this.setState({ ContractType: this.ContractTypes.value });\r\n  }\r\n  @autobind\r\n  private onRelativePartyChanged(e: any): void {\r\n    this.setState({ RelativeParty: this.RelativePartyinput.value.trim() });\r\n  }\r\n  @autobind\r\n  private onContractDeptChanged(e: any): void {\r\n    this.setState({ curDeptId: this.ContractDepts.value.trim() });\r\n  }\r\n  @autobind\r\n  private onContractStatuChanged(e: any): void {\r\n    this.setState({ ContractStatu: this.ContractStatus.value });\r\n  }\r\n  @autobind\r\n  private onContractMainBodyChanged(e: any): void {\r\n    this.setState({ ContractMainBody: this.ContractMainBodies.value });\r\n  }\r\n  @autobind\r\n  private onContractTitleChanged(e: any): void {\r\n    this.setState({ ContractTitle: this.ContractTitle.value });\r\n  }\r\n  @autobind\r\n  private onContractNoChanged(e: any): void {\r\n    this.setState({ ContractNo: this.ContractNo.value });\r\n  }\r\n  @autobind\r\n  private onContractCurrencyChanged(e: any): void {\r\n    this.setState({ ContractCurrency: this.ContractCurrencies.value });\r\n  }\r\n  @autobind\r\n  private setMinMoney(e: any): void {\r\n    if (isNaN(parseFloat(this.MinMoneyInput.value))) {\r\n      //  this.setState({ minMoney: \"\" });\r\n      if (this.MinMoneyInput.value.trim() === \"\") {\r\n        this.setState({ minMoney: \"\" });\r\n      }\r\n    } else {\r\n      this.setState({ minMoney: this.MinMoneyInput.value });\r\n    }\r\n  }\r\n  @autobind\r\n  private setMaxMoney(e: any): void {\r\n    // console.log(e);\r\n    if (isNaN(parseFloat(this.MaxMoneyInput.value))) {\r\n      //  this.setState({ maxMoney: \"\" });\r\n      if (this.MaxMoneyInput.value.trim() === \"\") {\r\n        this.setState({ maxMoney: \"\" });\r\n      }\r\n    } else {\r\n      this.setState({ maxMoney: this.MaxMoneyInput.value });\r\n    }\r\n  }\r\n  @autobind\r\n  private _setMinDate(value: Date): void {\r\n    this.setState({ ContractMinDate: value });\r\n  }\r\n  @autobind\r\n  private _setMaxDate(value: Date): void {\r\n    this.setState({ ContractMaxDate: value });\r\n  }\r\n  @autobind\r\n  private onAuthorChanged(\r\n    authors?: IOfficeUiFabricPeoplePickerSelection[]\r\n  ): void {\r\n    this.setState({ Author: authors });\r\n  }\r\n  private _pagedItemsTo(\r\n    PgItems: PagedItemCollection<any>,\r\n    targetPage: number,\r\n    PgNum: number\r\n  ): void {\r\n    PgNum--;\r\n    if (PgNum > 0 && PgItems.hasNext) {\r\n      PgItems.getNext().then(item => {\r\n        this._pagedItemsTo(item, targetPage, PgNum);\r\n      });\r\n      return;\r\n    }\r\n\r\n    let data: any[] = PgItems.results.map(item => {\r\n      return {\r\n        requestNo: item.requestNo,\r\n        state: statusDesc[item.status],\r\n        RelativeParty: item.RelativeParty,\r\n        mainbody: item.mainbody,\r\n        Title: item.Title,\r\n        NeedApproval: item.NeedApproval === false ? \"否\" : \"是\",\r\n        ContractType: item.ContractType ? item.ContractType.Title : \"\",\r\n        ContractNo: item.ContractNo,\r\n        ContractObject: item.ContractObject,\r\n        MoneyText: item.Money ? item.Money : \"N/A\",\r\n        Currency: item.Currency,\r\n        PayWay: item.PayWay,\r\n        remarks: item.remarks ? item.remarks : \"\",\r\n        Id: item.Id,\r\n        representative: item.representative ? item.representative.Title : \"\",\r\n        Author: item.Author.Title,\r\n        Created: moment(item.Created, moment.ISO_8601).format(\"YYYY/MM/DD\"),\r\n        signingDate:\r\n          item.signingDate && (item.signingDate + \"\").length > 6\r\n            ? moment(item.signingDate, moment.ISO_8601).format(\"YYYY/MM/DD\")\r\n            : \"\",\r\n        AttachmentFiles: item.AttachmentFiles.map(fileinfo => {\r\n          return {\r\n            ServerRelativeUrl: fileinfo.ServerRelativeUrl,\r\n            FileName: fileinfo.FileName\r\n          };\r\n        })\r\n      };\r\n    });\r\n    //  console.log(data);\r\n\r\n    this.setState({\r\n      requestedItems: data,\r\n      current: targetPage\r\n    });\r\n  }\r\n\r\n  private _pagedItemsToExcel(\r\n    PgItems: PagedItemCollection<any>,\r\n    expItems: any[],\r\n    attfinfos: any[]\r\n  ): void {\r\n    if (PgItems.hasNext) {\r\n      PgItems.getNext().then(items => {\r\n        this.fillDatas(items, expItems, attfinfos);\r\n      });\r\n      return;\r\n    }\r\n    let T: Date = new Date();\r\n    let ws_name: string =\r\n      \"合同申请表\" + T.getFullYear() + (T.getMonth() + 1) + T.getDate();\r\n    // if(typeof console !== 'undefined') console.log(new Date());\r\n    let wb: XLSX.WorkBook = XLSX.utils.book_new();\r\n    let ws: XLSX.WorkSheet = XLSX.utils.aoa_to_sheet(expItems);\r\n    for (let r: number = 0; r < expItems.length - 1; r++) {\r\n      attfinfos[r].map((att, index) => {\r\n        let celName: string =\r\n          XLSX.utils.encode_col(this.colKeys.length - 1 + index) + (r + 2);\r\n        //  console.log(celName);\r\n        if (ws[celName]) {\r\n          ws[celName].l = att;\r\n        }\r\n      });\r\n    }\r\n    /* add worksheet to workbook */\r\n    XLSX.utils.book_append_sheet(wb, ws, ws_name);\r\n    /* write workbook */\r\n    // if(typeof console !== 'undefined') console.log(new Date());\r\n    let filename: string = \"合同申请表_.xlsx\";\r\n    XLSX.writeFile(wb, GetFileRandName(filename));\r\n    this.getDatas();\r\n  }\r\n  private _fillreqdata(req: Items, page: number): void {\r\n    req.getPaged().then(reqbody => {\r\n      // console.log(reqbody);\r\n      this._pagedItemsTo(reqbody, page, page);\r\n    });\r\n  }\r\n\r\n  private fillDatas(\r\n    items: PagedItemCollection<any>,\r\n    expItems: any[],\r\n    attfinfos: any[]\r\n  ): void {\r\n    items.results.map(curitem => {\r\n      let rowdatas: any[] = [];\r\n      let rowatts: any[] = [];\r\n      for (let i: number = 0; i < this.colKeys.length; i++) {\r\n        if (this.colKeys[i] === \"AttachmentFiles\") {\r\n          // console.log(curitem[this.colKeys[i]]);\r\n          curitem[this.colKeys[i]].map((attf, index) => {\r\n            rowatts.push({\r\n              Target: WebConfig.hosturl + attf.ServerRelativeUrl,\r\n              Tooltip: attf.FileName\r\n            });\r\n            // return attf.FileName;\r\n            rowdatas[i + index] = attf.FileName;\r\n          });\r\n        } else if (this.colKeys[i] === \"state\") {\r\n          rowdatas[i] = statusDesc[curitem.status];\r\n        } else if (this.colKeys[i].indexOf(\"/\") > 0) {\r\n          if (\r\n            curitem.NeedApproval === false &&\r\n            this.colKeys[i] === \"pricingcenter/Title\"\r\n          ) {\r\n            rowdatas[i] = \"\";\r\n          } else {\r\n            let fields: string[] = this.colKeys[i].split(\"/\");\r\n            let tempObj: any = curitem[fields[0]];\r\n            rowdatas[i] = tempObj ? tempObj[fields[1]] : \"\";\r\n          }\r\n        } else if (this.colKeys[i] === \"NeedApproval\") {\r\n          rowdatas[i] = curitem.NeedApproval === false ? \"否\" : \"是\";\r\n        } else if (\r\n          this.colKeys[i] === \"Created\" ||\r\n          this.colKeys[i] === \"signingDate\"\r\n        ) {\r\n          if (curitem[this.colKeys[i]] && curitem[this.colKeys[i]].length > 6) {\r\n            rowdatas[i] = moment(\r\n              curitem[this.colKeys[i]],\r\n              moment.ISO_8601\r\n            ).format(\"YYYY/MM/DD\");\r\n          } else {\r\n            rowdatas[i] = \"\";\r\n          }\r\n        } else {\r\n          rowdatas[i] = curitem[this.colKeys[i]];\r\n        }\r\n      }\r\n      expItems.push(rowdatas);\r\n      attfinfos.push(rowatts);\r\n    });\r\n  }\r\n\r\n  @autobind\r\n  private _getpageditems(page: number): void {\r\n    // console.log(page);\r\n    let filterstr: string = this.state.filterstr;\r\n    let req: Items = sp.web.lists\r\n      .getByTitle(WebConfig.requestedItemsListName)\r\n      .items.filter(`${filterstr}`)\r\n      .select(\r\n        \"*\",\r\n        \"AttachmentFiles\",\r\n        \"ContractType/Title\",\r\n        \"representative/Title\",\r\n        \"Author/Title\",\r\n        \"pricingcenter/Title\",\r\n        \"lawyer/Title\"\r\n      )\r\n      .expand(\r\n        \"AttachmentFiles\",\r\n        \"ContractType\",\r\n        \"representative/Id\",\r\n        \"Author\",\r\n        \"pricingcenter\",\r\n        \"lawyer\"\r\n      )\r\n      .orderBy(\"Id\", false);\r\n\r\n    req = req.top(this.state.pageSize);\r\n\r\n    this._fillreqdata(req, page);\r\n  }\r\n}\r\n"],"sourceRoot":"..\\..\\..\\..\\src"}